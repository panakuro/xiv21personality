<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FF14 „Ç∏„Éß„ÉñÊÄßÊ†ºË®∫Êñ≠</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Noto+Serif+JP:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --gold: #c9a84c;
    --gold-light: #f0d080;
    --deep: #0a0812;
    --dark: #100e1a;
    --panel: #16122a;
    --panel2: #1e1838;
    --accent: #6a4fcf;
    --accent2: #9b6bff;
    --text: #e8dfc8;
    --text-dim: #8a7f6a;
    --glow: rgba(201,168,76,0.3);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Noto Serif JP', serif;
    background: var(--deep);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background stars */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      radial-gradient(circle at 20% 30%, rgba(106,79,207,0.15) 0%, transparent 50%),
      radial-gradient(circle at 80% 70%, rgba(201,168,76,0.08) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  .stars {
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
  }

  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: white;
    border-radius: 50%;
    animation: twinkle var(--dur, 3s) infinite;
    opacity: var(--op, 0.5);
  }

  @keyframes twinkle {
    0%, 100% { opacity: var(--op, 0.5); }
    50% { opacity: 0.1; }
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 60px;
    animation: fadeDown 1s ease;
  }

  .header-badge {
    display: inline-block;
    border: 1px solid var(--gold);
    padding: 4px 20px;
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--gold);
    margin-bottom: 24px;
    text-transform: uppercase;
  }

  h1 {
    font-family: 'Cinzel', serif;
    font-size: clamp(28px, 6vw, 52px);
    font-weight: 900;
    line-height: 1.1;
    background: linear-gradient(135deg, var(--gold-light), var(--gold), #a07030);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: none;
    margin-bottom: 12px;
  }

  .subtitle {
    color: var(--text-dim);
    font-size: 14px;
    letter-spacing: 1px;
  }

  /* Divider */
  .divider {
    display: flex;
    align-items: center;
    gap: 16px;
    margin: 24px 0;
  }
  .divider::before, .divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: linear-gradient(to right, transparent, var(--gold), transparent);
  }
  .divider-gem {
    width: 8px;
    height: 8px;
    background: var(--gold);
    transform: rotate(45deg);
  }

  /* Screen transitions */
  .screen {
    display: none;
    animation: fadeIn 0.6s ease;
  }
  .screen.active { display: block; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Intro card */
  .intro-card {
    border: 1px solid rgba(201,168,76,0.2);
    border-radius: 4px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .intro-hero-img {
    display: block;
    width: 100%;
    max-height: 560px;
    object-fit: contain;
    object-position: center;
  }

  .intro-overlay {
    position: absolute;
    inset: 0;
    background: rgba(10,8,18,0.55);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 48px 40px;
  }

  .intro-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    z-index: 2;
  }

  .intro-icon {
    margin-bottom: 28px;
    display: block;
  }

  .intro-card p {
    color: var(--text);
    line-height: 1.8;
    font-size: 14px;
    margin-bottom: 32px;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    text-shadow: 0 1px 10px rgba(0,0,0,1), 0 0 30px rgba(0,0,0,1);
  }

  /* Buttons */
  .btn {
    display: inline-block;
    padding: 14px 40px;
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 3px;
    cursor: pointer;
    border: none;
    transition: all 0.3s ease;
    text-transform: uppercase;
    text-decoration: none;
  }

  .btn-primary {
    background: linear-gradient(135deg, var(--gold), #a07030);
    color: var(--deep);
    font-weight: 700;
    box-shadow: 0 0 30px var(--glow);
  }

  .btn-primary:hover {
    box-shadow: 0 0 50px rgba(201,168,76,0.5);
    transform: translateY(-2px);
  }

  .btn-secondary {
    background: transparent;
    color: var(--gold);
    border: 1px solid var(--gold);
    margin-top: 12px;
  }

  .btn-secondary:hover {
    background: rgba(201,168,76,0.1);
  }

  /* Progress */
  .progress-bar {
    background: var(--panel);
    border: 1px solid rgba(201,168,76,0.2);
    height: 4px;
    border-radius: 2px;
    margin-bottom: 40px;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--gold));
    transition: width 0.5s ease;
    box-shadow: 0 0 10px var(--gold);
  }

  .progress-text {
    text-align: right;
    font-size: 11px;
    color: var(--text-dim);
    font-family: 'Cinzel', serif;
    letter-spacing: 2px;
    margin-bottom: 8px;
  }

  /* Question card */
  .question-card {
    background: var(--panel);
    border: 1px solid rgba(201,168,76,0.2);
    border-radius: 4px;
    padding: 40px;
    position: relative;
    overflow: hidden;
  }

  .question-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
  }

  .question-number {
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--gold);
    margin-bottom: 16px;
    text-transform: uppercase;
  }

  .question-text {
    font-size: clamp(16px, 3vw, 22px);
    font-weight: 700;
    line-height: 1.6;
    margin-bottom: 36px;
    color: var(--text);
  }

  /* Quiz instruction banner */
  .quiz-instruction {
    text-align: center;
    font-family: 'Cinzel', serif;
    font-size: 12px;
    letter-spacing: 3px;
    color: var(--gold);
    border: 1px solid rgba(201,168,76,0.25);
    padding: 10px 20px;
    margin-bottom: 28px;
    background: rgba(201,168,76,0.05);
  }

  /* Scale UI */
  .question-text {
    font-size: clamp(15px, 2.8vw, 20px);
    font-weight: 700;
    line-height: 1.7;
    margin-bottom: 32px;
    color: var(--text);
  }

  .scale-wrap {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .scale-row {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 10px 0;
    border-bottom: 1px solid rgba(201,168,76,0.07);
    cursor: pointer;
    transition: background 0.2s;
    border-radius: 3px;
  }

  .scale-row:last-child { border-bottom: none; }

  .scale-row:hover { background: rgba(201,168,76,0.05); }

  .scale-row.selected {
    background: rgba(201,168,76,0.08);
  }

  .scale-radio {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 2px solid rgba(201,168,76,0.3);
    flex-shrink: 0;
    transition: all 0.2s;
    position: relative;
    margin-left: 8px;
  }

  .scale-row.selected .scale-radio {
    border-color: var(--gold);
    background: var(--gold);
    box-shadow: 0 0 10px var(--glow);
  }

  .scale-row.selected .scale-radio::after {
    content: '';
    position: absolute;
    inset: 4px;
    background: var(--deep);
    border-radius: 50%;
  }

  .scale-label {
    font-size: 13px;
    color: var(--text-dim);
    transition: color 0.2s;
    line-height: 1.5;
  }

  .scale-row.selected .scale-label {
    color: var(--gold-light);
  }

  .scale-row:hover .scale-label {
    color: var(--text);
  }

  .scale-tag {
    margin-left: auto;
    margin-right: 8px;
    font-size: 10px;
    font-family: 'Cinzel', serif;
    letter-spacing: 1px;
    color: rgba(201,168,76,0.35);
    white-space: nowrap;
  }

  .scale-row.selected .scale-tag {
    color: var(--gold);
  }

  .next-btn {
    display: block;
    margin: 28px auto 0;
    padding: 12px 40px;
    background: linear-gradient(135deg, var(--gold), #a07030);
    color: var(--deep);
    font-family: 'Cinzel', serif;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 3px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    opacity: 0;
    pointer-events: none;
  }

  .next-btn.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .next-btn:hover {
    box-shadow: 0 0 30px var(--glow);
    transform: translateY(-2px);
  }

  /* Loading */
  .loading {
    text-align: center;
    padding: 80px 20px;
  }

  .crystal {
    width: 60px;
    height: 60px;
    margin: 0 auto 32px;
    position: relative;
  }

  .crystal-inner {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--accent), var(--gold));
    clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);
    animation: pulse 1.5s infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.7; }
  }

  .loading-text {
    font-family: 'Cinzel', serif;
    color: var(--gold);
    letter-spacing: 4px;
    font-size: 13px;
  }

  /* Result card */
  .result-card {
    text-align: center;
  }

  /* „Ç∏„Éß„Éñ„Ç¢„Éº„ÉàÔºöÂÖ®ÂπÖ„Éí„Éº„É≠„ÉºË°®Á§∫ */
  .result-hero {
    position: relative;
    width: 100%;
    max-width: 700px;
    margin: 0 auto 32px;
    border-radius: 4px;
    overflow: hidden;
  }

  .result-job-art {
    width: 100%;
    height: auto;
    max-height: 520px;
    object-fit: cover;
    object-position: top center;
    display: block;
    filter: drop-shadow(0 0 40px rgba(201,168,76,0.3));
    animation: float 4s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }

  @media (max-width: 500px) {
    .result-job-art { max-height: 340px; }
  }

  /* ÁîªÂÉè‰∏ä„ÅÆ„Ç™„Éº„Éê„Éº„É¨„Ç§„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ */
  .result-hero::after {
    content: '';
    position: absolute;
    inset: 0;
    background:
      linear-gradient(to top, rgba(10,8,18,0.95) 0%, rgba(10,8,18,0.4) 40%, transparent 70%),
      linear-gradient(to bottom, rgba(10,8,18,0.5) 0%, transparent 30%);
    pointer-events: none;
  }

  /* „Ç™„Éº„Éê„Éº„É¨„Ç§„ÉÜ„Ç≠„Çπ„ÉàÔºàÁîªÂÉè„ÅÆ‰∏äÔºâ */
  .result-overlay-top {
    position: absolute;
    top: 20px;
    left: 0; right: 0;
    z-index: 2;
    text-align: center;
    padding: 0 20px;
  }

  .result-overlay-bottom {
    position: absolute;
    bottom: 24px;
    left: 0; right: 0;
    z-index: 2;
    text-align: center;
    padding: 0 20px;
  }

  .result-mbti {
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 6px;
    color: var(--accent2);
    text-shadow: 0 0 20px rgba(155,107,255,0.8);
    margin-bottom: 6px;
  }

  .result-job-name {
    font-family: 'Cinzel', serif;
    font-size: clamp(36px, 9vw, 72px);
    font-weight: 900;
    background: linear-gradient(135deg, #fff 0%, var(--gold-light) 40%, var(--gold) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1;
    margin-bottom: 6px;
    text-shadow: none;
    filter: drop-shadow(0 2px 20px rgba(201,168,76,0.6));
  }

  .result-job-name-jp {
    font-size: 15px;
    color: rgba(232,223,200,0.8);
    letter-spacing: 2px;
  }

  .result-panel {
    background: var(--panel);
    border: 1px solid rgba(201,168,76,0.2);
    border-radius: 4px;
    padding: 32px;
    margin: 24px 0;
    position: relative;
    overflow: hidden;
    text-align: left;
  }

  .result-panel::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
  }

  .result-desc {
    font-size: 15px;
    line-height: 2;
    color: var(--text);
    margin-bottom: 24px;
  }

  .traits {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 16px;
  }

  .trait {
    padding: 4px 14px;
    border: 1px solid rgba(201,168,76,0.3);
    font-size: 12px;
    color: var(--gold);
    letter-spacing: 1px;
    font-family: 'Cinzel', serif;
  }

  .score-bars {
    margin-top: 24px;
  }

  .score-bar {
    margin-bottom: 12px;
  }

  .score-label {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    color: var(--text-dim);
    margin-bottom: 6px;
    letter-spacing: 1px;
  }

  .score-track {
    height: 6px;
    background: rgba(255,255,255,0.05);
    border-radius: 3px;
    overflow: hidden;
  }

  .score-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 1s ease 0.5s;
  }




  /* Role triangle chart */
  .role-chart {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(201,168,76,0.15);
  }

  .role-chart-title {
    text-align: center;
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 3px;
    color: var(--text-dim);
    margin-bottom: 16px;
    text-transform: uppercase;
  }

  .role-pentagon {
    display: block;
    margin: 0 auto;
  }

  /* Share */
  .share-area {
    margin-top: 32px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .btn-x {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 14px 32px;
    background: #000;
    color: #fff;
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 3px;
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 2px;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.3s ease;
  }

  .btn-x:hover {
    background: #1a1a1a;
    border-color: rgba(255,255,255,0.4);
    transform: translateY(-2px);
  }

  .btn-x svg {
    width: 18px;
    height: 18px;
    fill: white;
  }

  .btn-retry {
    background: transparent;
    color: var(--text-dim);
    border: 1px solid rgba(201,168,76,0.2);
    padding: 10px 24px;
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 3px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
  }

  .btn-retry:hover {
    color: var(--gold);
    border-color: var(--gold);
  }

  /* Axes labels */
  .axes {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-top: 16px;
  }

  .axis-label {
    font-size: 11px;
    color: var(--text-dim);
    letter-spacing: 1px;
  }

  /* Áõ∏ÊÄß„Ç∏„Éß„Éñ„Çª„ÇØ„Ç∑„Éß„É≥ */
  .compat-section {
    margin-bottom: 24px;
  }
  .compat-title {
    font-family: 'Cinzel', serif;
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--gold);
    text-align: center;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
  }
  .compat-title-deco { opacity: 0.5; }
  .compat-subtitle {
    font-size: 12px;
    color: var(--text-dim);
    text-align: center;
    letter-spacing: 2px;
    margin-bottom: 20px;
  }
  .compat-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }
  .compat-card {
    display: flex;
    gap: 16px;
    align-items: center;
    background: var(--panel2);
    border: 1px solid rgba(201,168,76,0.15);
    border-radius: 4px;
    padding: 14px 16px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.2s;
  }
  .compat-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(201,168,76,0.3), transparent);
  }
  .compat-card:hover { border-color: rgba(201,168,76,0.35); }
  .compat-img-wrap {
    width: 90px;
    height: 90px;
    flex-shrink: 0;
    overflow: hidden;
    background: transparent;
  }
  .compat-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: top center;
  }
  .compat-icon-fallback {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
  }
  .compat-info { flex: 1; min-width: 0; }
  .compat-mbti {
    font-family: 'Cinzel', serif;
    font-size: 10px;
    letter-spacing: 3px;
    color: var(--accent2);
    margin-bottom: 3px;
  }
  .compat-name {
    font-family: 'Cinzel', serif;
    font-size: 17px;
    font-weight: 700;
    color: var(--text);
    margin-bottom: 2px;
    line-height: 1.2;
  }
  .compat-name-jp {
    font-size: 11px;
    color: var(--text-dim);
    letter-spacing: 1px;
    margin-bottom: 8px;
  }
  .compat-comment {
    font-size: 12px;
    color: rgba(232,223,200,0.75);
    line-height: 1.7;
  }
  .compat-badge {
    position: absolute;
    top: 10px; right: 12px;
    font-family: 'Cinzel', serif;
    font-size: 9px;
    letter-spacing: 1px;
    padding: 2px 8px;
    border-radius: 2px;
    border: 1px solid;
  }

/* === Image placeholders (Base64 removed) ===
   This file intentionally removes heavy base64 images for editing with Claude.
   Replace placeholder src with your own images later if needed.
*/
img[src=""], img:not([src]) { background: rgba(255,255,255,0.03); }

</style>
</head>
<body>

<div class="stars" id="stars"></div>

<div class="container">
  <div class="header">
    <div class="header-badge">Eorzea Job Divination</div>
    <h1>FF14 „Ç∏„Éß„ÉñÊÄßÊ†ºË®∫Êñ≠</h1>
    <p class="subtitle">„ÅÇ„Å™„Åü„ÅÆÈ≠Ç„ÅåÂëº„Å∂„Ç∏„Éß„Éñ„Çí„ÄÅÊòü„ÅåÂëä„Åí„Çã</p>
    <div class="divider"><div class="divider-gem"></div></div>
  </div>

  <!-- Intro Screen -->
  <div class="screen active" id="screen-intro">
    <div class="intro-card">
      <img class="intro-hero-img" src="image/Crystal.png" alt="">
      <div class="intro-overlay">
        <p>
          24„ÅÆÂïè„ÅÑ„Å´Á≠î„Åà„Çã„Åì„Å®„Åß„ÄÅ<br>„ÅÇ„Å™„Åü„ÅÆÂÜÖ„Å™„ÇãÊÄßÊ†º„Åã„Çâ„Ç®„Ç™„É´„Çº„Ç¢„Å´Áõ∏Âøú„Åó„ÅÑ„Ç∏„Éß„Éñ„ÇíÂ∞é„ÅçÂá∫„Åó„Åæ„Åô„ÄÇ<br>
          MBTIÁöÑ„Å™4Ëª∏ÔºàE/I„ÉªS/N„ÉªT/F„ÉªJ/PÔºâ„Çí„ÇÇ„Å®„Å´<br>21„ÅÆ„Ç∏„Éß„Éñ„Çø„Ç§„Éó„Å∏„Éû„ÉÉ„Éî„É≥„Ç∞„ÄÇ<br>
          Ë®∫Êñ≠ÁµêÊûú„ÅØX„Åß„Ç∑„Çß„Ç¢„Åß„Åç„Åæ„Åô„ÄÇ
        </p>
        <button class="btn btn-primary" onclick="startQuiz()">Ë®∫Êñ≠„ÇíÂßã„ÇÅ„Çã</button>
        <button class="btn btn-secondary" id="debug-btn" style="display:none" onclick="runDebugSimulation()">„Éá„Éê„ÉÉ„Ç∞Ôºö„É©„É≥„ÉÄ„É†10,000Âõû</button>
        <div id="debug-status" style="display:none;margin-top:10px;font-size:12px;color:rgba(232,223,200,0.7);"></div>
      </div>
    </div>
  </div>

  <!-- Quiz Screen -->
  <div class="screen" id="screen-quiz">
    <div class="quiz-instruction">Ëá™ÂàÜ„Å´Ëøë„ÅÑ„ÇÇ„ÅÆ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
    <div class="progress-text" id="progress-text">Question 1 / 20</div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill" style="width:5%"></div>
    </div>
    <div class="question-card" id="question-card">
      <div class="question-number" id="question-number">Á¨¨ 1 Âïè</div>
      <div class="question-text" id="question-text"></div>
      <div id="scale-area"></div>
    </div>
  </div>

  <!-- Loading Screen -->
  <div class="screen" id="screen-loading">
    <div class="loading">
      <div class="crystal"><div class="crystal-inner"></div></div>
      <div class="loading-text">Âç†ÊòüÁõ§„ÅåÂªª„Çã...</div>
    </div>
  </div>

  <!-- Result Screen -->
  <div class="screen" id="screen-result">
    <div class="result-card">

      <!-- „Éí„Éº„É≠„ÉºÁîªÂÉè + „ÉÜ„Ç≠„Çπ„Éà„Ç™„Éº„Éê„Éº„É¨„Ç§ -->
      <div class="result-hero">
        <span id="result-icon"></span>
        <div class="result-overlay-top">
          <div class="result-mbti" id="result-mbti"></div>
        </div>
        <div class="result-overlay-bottom">
          <div class="result-job-name" id="result-job-name"></div>
          <div class="result-job-name-jp" id="result-job-name-jp"></div>
        </div>
      </div>

      <div class="result-panel">
        <div class="result-desc" id="result-desc"></div>
        <div class="traits" id="result-traits"></div>
        <div class="score-bars" id="score-bars"></div>
      </div>

      <!-- Áõ∏ÊÄß„Ç∏„Éß„Éñ -->
      <div class="compat-section">
        <div class="compat-title">
          <span class="compat-title-deco">‚ú¶</span>
          COMPATIBLE JOBS
          <span class="compat-title-deco">‚ú¶</span>
        </div>
        <div class="compat-subtitle">Áõ∏ÊÄß„ÅÆ„ÅÑ„ÅÑ„Ç∏„Éß„Éñ</div>
        <div class="compat-list" id="compat-list"></div>
      </div>

      <div class="share-area">
        <a class="btn-x" id="share-btn" href="#" target="_blank">
          <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.741l7.73-8.835L1.254 2.25H8.08l4.259 5.622L18.243 2.25zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          X„Åß„Ç∑„Çß„Ç¢„Åô„Çã
        </a>
        <button class="btn-retry" onclick="restartQuiz()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶Ë®∫Êñ≠„Åô„Çã</button>
      </div>
    </div>
  </div>
</div>

<script>
const JOB_IMAGES = {
  Paladin: "image/jobart/Paladin.png",
  Warrior: "image/jobart/Warrior.png",
  DarkKnight: "image/jobart/Dark_Knight.png",
  Gunbreaker: "image/jobart/Gunbreaker.png",
  WhiteMage: "image/jobart/White_Mage.png",
  Scholar: "image/jobart/Scholar.png",
  Astrologian: "image/jobart/Astrologian.png",
  Sage: "image/jobart/Sage.png",
  Monk: "image/jobart/Monk.png",
  Ninja: "image/jobart/Ninja.png",
  Reaper: "image/jobart/Reaper.png",
  Samurai: "image/jobart/Samurai.png",
  Viper: "image/jobart/Viper.png",
  Dragoon: "image/jobart/Dragoon.png",
  Bard: "image/jobart/Bard.png",
  Dancer: "image/jobart/Dancer.png",
  Machinist: "image/jobart/Machinist.png",
  Summoner: "image/jobart/Summoner.png",
  BlackMage: "image/jobart/Black_Mage.png",
  RedMage: "image/jobart/Red_Mage.png",
  Pictomancer: "image/jobart/Pictomancer.png",
  BlueMage: "image/jobart/Blue_Mage.png",
};

// ===== 7ÊÆµÈöé„É©„Éô„É´ =====
const SCALE = [
  { val: +3, label: "Âº∑„Åè„Åù„ÅÜÊÄù„ÅÜ" },
  { val: +2, label: "„Åù„ÅÜÊÄù„ÅÜ" },
  { val: +1, label: "„Å©„Å°„Çâ„Åã„Å®„ÅÑ„Åà„Å∞„Åù„ÅÜÊÄù„ÅÜ" },
  { val:  0, label: "„Å©„Å°„Çâ„Å®„ÇÇ„ÅÑ„Åà„Å™„ÅÑ" },
  { val: -1, label: "„Å©„Å°„Çâ„Åã„Å®„ÅÑ„Åà„Å∞„Åù„ÅÜÊÄù„Çè„Å™„ÅÑ" },
  { val: -2, label: "„Åù„ÅÜÊÄù„Çè„Å™„ÅÑ" },
  { val: -3, label: "ÂÖ®„Åè„Åù„ÅÜÊÄù„Çè„Å™„ÅÑ" },
];

// ===== Ë≥™Âïè„Éá„Éº„ÇøÔºà24Âïè„Éª1Âïè1Ëª∏„ÉªÊ≠£Ëª¢3ÔºãÈÄÜËª¢3„ÅÆÂØæÁß∞Ë®≠Ë®àÔºâ=====
// axis „ÅÆÊ≠£ÊñπÂêë = E / S / T / J
// reversed:true „ÅÆÂïè„ÅØÂõûÁ≠îÂÄ§„ÇíÂèçËª¢„Åó„Å¶Âä†ÁÆó
const questions = [
  // ‚îÄ‚îÄ E / IÔºàÊ≠£Ëª¢3„ÉªÈÄÜËª¢3Ôºâ‚îÄ‚îÄ
  { axis:"EI", reversed:false, text:"ÂàùÂØæÈù¢„ÅÆ‰∫∫„Å®„Åß„ÇÇ„ÄÅË©±„Åó„Å¶„ÅÑ„Çã„ÅÜ„Å°„Å´Ëá™ÁÑ∂„Å®Êâì„Å°Ëß£„Åë„Çâ„Çå„ÇãÊñπ„Å†„ÄÇ" },
  { axis:"EI", reversed:false, text:"„Ç∞„É´„Éº„Éó„Åß‰Ωï„Åã„Çí„Åô„Çã„Å®„Åç„ÄÅËá™ÂàÜ„Åã„ÇâÊÑèË¶ã„ÇíÂá∫„Åó„Å¶„Åæ„Å®„ÇÅÂΩπ„Å´„Å™„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„ÄÇ" },
  { axis:"EI", reversed:false, text:"ÈÄ±Êú´„ÅØË™∞„Åã„Å®ÈÅé„Åî„Åô‰∫àÂÆö„ÇíÂÖ•„Çå„ÅüÊñπ„Åå„ÄÅÂÖÖÂÆüÊÑü„ÇíÊÑü„Åò„ÇÑ„Åô„ÅÑ„ÄÇ" },
  { axis:"EI", reversed:true,  text:"Èï∑„ÅÑÊôÇÈñì‰∫∫„Å®‰∏ÄÁ∑í„Å´„ÅÑ„Çã„Å®„ÄÅ„Å≤„Å®„Çä„Å´„Å™„Å£„Å¶ÂõûÂæ©„Åó„Åü„Åè„Å™„Çã„ÄÇ" },
  { axis:"EI", reversed:true,  text:"Ëá™ÂàÜ„ÅÆËÄÉ„Åà„ÇíÂè£„Å´Âá∫„Åô„Çà„Çä„ÄÅÈ†≠„ÅÆ‰∏≠„ÅßÊï¥ÁêÜ„Åó„Å¶„Åã„ÇâË©±„ÅôÊñπ„ÅåÂ•Ω„Åç„Å†„ÄÇ" },
  { axis:"EI", reversed:true,  text:"Ë≥ë„ÇÑ„Åã„Å™Â†¥„Å´„ÅÑ„Çã„Çà„Çä„ÄÅÈùô„Åã„Å™Áí∞Â¢É„Åß„Å≤„Å®„Çä„Å´ÈõÜ‰∏≠„Åó„Å¶„ÅÑ„ÇãÊñπ„ÅåËêΩ„Å°ÁùÄ„Åè„ÄÇ" },

  // ‚îÄ‚îÄ S / NÔºàÊ≠£Ëª¢3„ÉªÈÄÜËª¢3Ôºâ‚îÄ‚îÄ
  { axis:"SN", reversed:false, text:"„Ç¢„Ç§„Éá„Ç¢„ÇíËÄÉ„Åà„Çã„Çà„Çä„ÄÅÂÖ∑‰ΩìÁöÑ„Å™‰ΩúÊ•≠„Çí„Åì„Å™„Åó„Å¶„ÅÑ„ÇãÊñπ„ÅåÂÖÖÂÆüÊÑü„Åå„ÅÇ„Çã„ÄÇ" },
  { axis:"SN", reversed:false, text:"Áâ©‰∫ã„ÇíÂà§Êñ≠„Åô„Çã„Å®„Åç„ÄÅÂãò„ÇÑÁõ¥ÊÑü„Çà„ÇäÂÆüÁ∏æ„ÇÑÁµåÈ®ì„Çí„ÇÇ„Å®„Å´„Åô„ÇãÊñπ„Åå‰ø°È†º„Åß„Åç„Çã„ÄÇ" },
  { axis:"SN", reversed:false, text:"Êñ∞„Åó„ÅÑ„Åì„Å®„ÇíË¶ö„Åà„Çã„Å®„Åç„ÄÅÊâãÈ†Ü„Çí‰∏Ä„Å§„Åö„Å§Á¢∫ÂÆü„Å´Ë∫´„Å´„Å§„Åë„Å¶„ÅÑ„ÅèÊñπ„ÅåÂ•Ω„Åç„Å†„ÄÇ" },
  { axis:"SN", reversed:true,  text:"ÁõÆ„ÅÆÂâç„ÅÆ„Åì„Å®„Çà„Çä„ÄÅ„Åù„ÅÆÂÖà„Å´‰Ωï„Åå„ÅÇ„Çã„Åã„ÇíËÄÉ„Åà„Å¶„ÅÑ„ÇãÊñπ„ÅåÊ•Ω„Åó„ÅÑ„ÄÇ" },
  { axis:"SN", reversed:true,  text:"Êó¢Â≠ò„ÅÆ„ÇÑ„ÇäÊñπ„Çà„Çä„ÄÅ„ÇÇ„Å£„Å®ËâØ„ÅÑÊñπÊ≥ï„Åå„ÅÇ„Çã„ÅØ„Åö„Å†„Å®ËÄÉ„Åà„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„ÄÇ" },
  { axis:"SN", reversed:true,  text:"Á¥∞„Åã„ÅÑ‰∫ãÂÆü„ÇíÁ©ç„Åø‰∏ä„Åí„Çã„Çà„Çä„ÄÅÂÖ®‰Ωì„ÅÆÊÑèÂë≥„ÇÑ„Éë„Çø„Éº„É≥„ÇíÊé¥„ÇÄÊñπ„ÅåÂæóÊÑè„Å†„ÄÇ" },

  // ‚îÄ‚îÄ T / FÔºàÊ≠£Ëª¢3„ÉªÈÄÜËª¢3Ôºâ‚îÄ‚îÄ
  { axis:"TF", reversed:false, text:"ÊÑüÊÉÖÁöÑ„Å™Â†¥Èù¢„Åß„ÇÇ„ÄÅ„Åæ„ÅöÁä∂Ê≥Å„ÇíÊï¥ÁêÜ„Åó„Å¶Ë´ñÁêÜÁöÑ„Å´ÂØæÂøú„Åó„Çà„ÅÜ„Å®„Åô„ÇãÊñπ„Å†„ÄÇ" },
  { axis:"TF", reversed:false, text:"Ë™∞„Åã„ÅÆ„ÇÑ„ÇäÊñπ„Å´ÂïèÈ°å„Åå„ÅÇ„Çã„Å®ÊÄù„Å£„Åü„Å®„Åç„ÄÅÁõ∏Êâã„ÅÆÊ∞óÊåÅ„Å°„Çà„ÇäÊ≠£„Åó„Åï„ÇíÂÑ™ÂÖà„Åô„Çã„ÄÇ" },
  { axis:"TF", reversed:false, text:"ÊÑèË¶ã„ÅåÂØæÁ´ã„Åó„Åü„Å®„Åç„ÄÅÁõ∏Êâã„Å®„ÅÆÈñ¢‰øÇ„Çà„ÇäË©±„ÅÆÁ≠ã„ÅåÈÄö„Å£„Å¶„ÅÑ„Çã„Åã„ÇíÂÖà„Å´ËÄÉ„Åà„Çã„ÄÇ" },
  { axis:"TF", reversed:true,  text:"Ê≠£„Åó„ÅÑ„Åì„Å®„Çà„Çä„ÄÅÁõ∏Êâã„Åå„Å©„ÅÜÊÑü„Åò„Çã„Åã„ÇíÂÖà„Å´ËÄÉ„Åà„Å¶„Åó„Åæ„ÅÜ„ÄÇ" },
  { axis:"TF", reversed:true,  text:"Ê±∫Êñ≠„Åô„Çã„Å®„Åç„ÄÅÁêÜÂ±à„Çà„Çä„ÇÇËá™ÂàÜ„ÇÑÂë®Âõ≤„ÅÆÊ∞óÊåÅ„Å°„ÅåÊ±∫„ÇÅÊâã„Å´„Å™„Çã„Åì„Å®„ÅåÂ§ö„ÅÑ„ÄÇ" },
  { axis:"TF", reversed:true,  text:"Ë™∞„Åã„ÅåËêΩ„Å°Ëæº„Çì„Åß„ÅÑ„Çã„Å®„Åç„ÄÅÂéüÂõ†„ÅÆÂàÜÊûê„Çà„ÇäÂÖà„Å´Ê∞óÊåÅ„Å°„Å´ÂØÑ„ÇäÊ∑ª„ÅÑ„Åü„Åè„Å™„Çã„ÄÇ" },

  // ‚îÄ‚îÄ J / PÔºàÊ≠£Ëª¢3„ÉªÈÄÜËª¢3Ôºâ‚îÄ‚îÄ
  { axis:"JP", reversed:false, text:"‰Ωï„Åã„ÇíÂßã„ÇÅ„ÇãÂâç„Å´„ÄÅ„Ç¥„Éº„É´„Å®ÊÆµÂèñ„Çä„ÇíÊ±∫„ÇÅ„Å¶„Åä„Åã„Å™„ÅÑ„Å®ËêΩ„Å°ÁùÄ„Åã„Å™„ÅÑ„ÄÇ" },
  { axis:"JP", reversed:false, text:"Á∑†„ÇÅÂàá„Çä„ÇÑÁ¥ÑÊùü„ÅØ„ÄÅÂâçÂÄí„Åó„ÅßÁâá‰ªò„Åë„Å¶„Åä„ÅèÊñπ„ÅåÊ∞óÊåÅ„Å°„Çà„ÅèÈÅé„Åî„Åõ„Çã„ÄÇ" },
  { axis:"JP", reversed:false, text:"Ê±∫„ÇÅ„Åü„Åì„Å®„ÇíÊúÄÂæå„Åæ„Åß‰∏ÄË≤´„Åó„Å¶„ÇÑ„ÇäÈÅÇ„Åí„Çã„Åì„Å®„Å´„ÄÅ„Åì„Å†„Çè„Çä„Åå„ÅÇ„ÇãÊñπ„Å†„ÄÇ" },
  { axis:"JP", reversed:true,  text:"Ë®àÁîª„Çà„Çä„ÄÅ„Åù„ÅÆ„Å®„Åç„ÅÆÊµÅ„Çå„ÇÑÊ∞óÂàÜ„Å´Âêà„Çè„Åõ„Å¶Âãï„ÅèÊñπ„ÅåËá™ÂàÜ„Çâ„Åó„ÅÑ„ÄÇ" },
  { axis:"JP", reversed:true,  text:"ÈÅ∏ÊäûËÇ¢„Çí„Å™„Çã„Åπ„ÅèÈñã„ÅÑ„Åü„Åæ„Åæ„Å´„Åó„Å¶„Åä„Åç„Åü„ÅÑ„ÄÅÊó©„ÅèÊ±∫„ÇÅ„Çã„ÅÆ„ÅåËã¶Êâã„Å†„ÄÇ" },
  { axis:"JP", reversed:true,  text:"„ÇÑ„Çã„Åì„Å®„ÇíÊ±∫„ÇÅ„Åö„Å´Âãï„ÅçÂßã„ÇÅ„Å¶„ÄÅÂæå„Åã„ÇâÂΩ¢„ÇíÊï¥„Åà„Å¶„ÅÑ„ÅèÊñπ„ÅåÊÄß„Å´Âêà„Å£„Å¶„ÅÑ„Çã„ÄÇ" },
];
  // Expose for debug tools
  window.questions = questions;

// ===== „É≠„Éº„É´Âà§ÂÆöÔºàMBTI„Çπ„Ç≥„Ç¢„ÅÆ„Åø„Åã„ÇâÂ∞éÂá∫Ôºâ=====
//
// ÂêÑËª∏„ÅÆÊÑèÂë≥Ôºö
//   EI: E(+)=ÈõÜÂõ£„ÉªÂ§ñÂêë„Åç ‚Üí TANK/HEALERÂêë„Åç  I(-)=ÂçòÁã¨„ÉªÂÜÖÂêë„Åç ‚Üí CDPS/RDPSÂêë„Åç
//   TF: T(+)=Ë´ñÁêÜ„ÉªÂÜ∑Èùô   ‚Üí TANK/MDPSÂêë„Åç    F(-)=ÂÖ±ÊÑü„ÉªÊÑüÊÉÖ   ‚Üí HEALER/RDPSÂêë„Åç
//   SN: S(+)=ÂÆüË∑µ„ÉªË∫´‰Ωì   ‚Üí MDPS/RDPSÂêë„Åç    N(-)=Áõ¥ÊÑü„ÉªÁêÜË´ñ   ‚Üí CDPSÂêë„Åç
//   JP: J(+)=Ë≤¨‰ªª„ÉªË®àÁîª   ‚Üí TANK/HEALERÂêë„Åç  P(-)=Ëá™Áî±„ÉªÂç≥Ëàà   ‚Üí DPSÂÖ®Ëà¨Âêë„Åç
//
// ÂêÑËª∏„Çπ„Ç≥„Ç¢„Çí -15„Äú+15 „ÅÆÁØÑÂõ≤„ÅßÂèó„ÅëÂèñ„Çä„ÄÅÂêÑ„É≠„Éº„É´„Å∏„ÅÆÈáç„Åø‰ªò„Åç„Çπ„Ç≥„Ç¢„ÇíÁÆóÂá∫„Åó„Å¶ÊúÄÂ§ß„ÇíËøî„Åô

function determineRoleScores(axisScores) {
  // FF14„Éó„É¨„Ç§„É§„Éº„ÅØI„ÉªNÂØÑ„Çä„ÅÆÊØçÈõÜÂõ£„Éê„Ç§„Ç¢„Çπ„Åå„ÅÇ„Çã„Åü„ÇÅË£úÊ≠£
  const norm = (x, offset = 0) => {
    const v = (Number(x) || 0) - offset;
    return Math.max(-1, Math.min(1, v / 12));
  };

  const ei = norm(axisScores.EI, 0);
  const sn = norm(axisScores.SN, 0);
  const tf = norm(axisScores.TF, 0);
  const jp = norm(axisScores.JP, 0);

  const s = { TANK: 0, HEALER: 0, MDPS: 0, RDPS: 0, CDPS: 0 };

  // EI
  s.TANK   += ei * 0.15;
  s.HEALER += ei * 0.18;
  s.RDPS   += ei * 0.18;
  s.CDPS   -= ei * 0.18;
  s.MDPS   -= ei * 0.08;

  // TF: T‚ÜíTANK/MDPS/CDPS, F‚ÜíHEALER/RDPS
  s.MDPS   += tf * 0.25;
  s.TANK   += tf * 0.25;
  s.CDPS   += tf * 0.20;
  s.HEALER -= tf * 0.28;
  s.RDPS   -= tf * 0.15;

  // SN: S‚ÜíMDPS/RDPS/TANK, N‚ÜíCDPS
  s.MDPS   += sn * 0.20;
  s.RDPS   += sn * 0.18;
  s.TANK   += sn * 0.20;
  s.CDPS   -= sn * 0.22;
  s.HEALER -= sn * 0.08;

  // JP: J‚ÜíHEALER/TANK, P‚ÜíDPS/CDPS
  s.TANK   += jp * 0.10;
  s.HEALER += jp * 0.18;
  s.MDPS   -= jp * 0.12;
  s.RDPS   -= jp * 0.12;
  s.CDPS   += jp * 0.05;

  return s;
}

function determineRole(axisScores) {
  const s = determineRoleScores(axisScores);
  let bestRole = 'MDPS';
  let bestScore = -Infinity;
  for (const [role, score] of Object.entries(s)) {
    if (score > bestScore) { bestScore = score; bestRole = role; }
  }
  return bestRole;
}

function determineRole(axisScores) {
  const s = determineRoleScores(axisScores);

  // ÊúÄÈ´ò„Çπ„Ç≥„Ç¢„ÅÆ„É≠„Éº„É´„ÇíÁ¢∫ÂÆöÁöÑ„Å´Ëøî„Åô
  // Ôºàsoftmax„Çµ„É≥„Éó„É™„É≥„Ç∞„ÅØÂÇæÂêë„Å®ÈÅï„ÅÜÁµêÊûú„ÇíËøî„Åô„Åì„Å®„Åå„ÅÇ„Çã„Åü„ÇÅÂªÉÊ≠¢Ôºâ
  let bestRole = 'MDPS';
  let bestScore = -Infinity;
  for (const [role, score] of Object.entries(s)) {
    if (score > bestScore) {
      bestScore = score;
      bestRole = role;
    }
  }
  return bestRole;
}

// ===== „Ç∏„Éß„Éñ„Éû„Çπ„Çø =====
// key: MBTI_ROLE
const jobMap = {
  // ‚îÄ‚îÄ‚îÄ TANK ‚îÄ‚îÄ‚îÄ
  ENTJ_TANK: { name:"Paladin",    nameJp:"„Éä„Ç§„Éà",       icon:"üõ°Ô∏è", color:"#5b8dd9", role:"„Çø„É≥„ÇØ",
    desc:"Âº∑Èù≠„Å™ÊÑèÂøó„Å®ÂÜ∑Èùô„Å™ÊåáÊèÆÂäõ„ÅßÂâçÁ∑ö„ÇíÁéá„ÅÑ„Çã„É™„Éº„ÉÄ„Éº„ÄÇ‰ª≤Èñì„ÇíÂÆà„Çä„Å™„Åå„ÇâÊà¶Â†¥„ÇíÊîØÈÖç„Åô„Çã„Éä„Ç§„Éà„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„ÄåÊ≠£Áæ©„Çí‰ΩìÁèæ„Åô„ÇãËÄÖ„Äç„Å®„Åó„Å¶„ÅÆÊú¨Ë≥™„Åù„ÅÆ„ÇÇ„ÅÆ„ÄÇ",
    traits:["„É™„Éº„ÉÄ„Éº„Ç∑„ÉÉ„Éó","Ê±∫Êñ≠Âäõ","Êà¶Áï•ÊÄùËÄÉ","‰ΩøÂëΩÊÑü"], imgKey:"Paladin" },
  ESTJ_TANK: { name:"Warrior",    nameJp:"Êà¶Â£´",         icon:"ü™ì", color:"#c04b1a", role:"„Çø„É≥„ÇØ",
    desc:"Âäõ„Å®Ë¶èÂæã„ÅßÊà¶Â†¥„ÇíÂà∂„Åô„Çã‰∏çÂãï„ÅÆÁõæ„ÄÇÊà¶Â£´„ÅÆÂúßÂÄíÁöÑ„Å™Ëá™Â∑±ÂõûÂæ©„Å®ÂÆâÂÆö„Åó„ÅüÂ≠òÂú®ÊÑü„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„ÄåÂÆüÁõ¥„Éª‰ø°È†º„ÉªË°åÂãïÂäõ„Äç„ÅÆ‰∏âÊãçÂ≠ê„ÇíË±°Âæ¥„Åó„Åæ„Åô„ÄÇÈÄÉ„Åí„Åö„ÄÅÈÄÄ„Åã„Åö„ÄÅ„Åü„Å†Ââç„Å∏„ÄÇ",
    traits:["ÂÆüÁõ¥","ÂøçËÄêÂäõ","ÂÆâÂÆöÊÑü","Ë°åÂãïÂäõ"], imgKey:"Warrior" },
  ISTJ_TANK: { name:"Dark Knight", nameJp:"ÊöóÈªíÈ®éÂ£´",    icon:"üåë", color:"#4040a0", role:"„Çø„É≥„ÇØ",
    desc:"ÂÜÖ„Å™„ÇãÊöóÈóá„Å®Âêë„ÅçÂêà„ÅÑ„Å™„Åå„Çâ‰ª≤Èñì„ÇíÂÆà„ÇãË™†ÂÆü„Å™Â≠§Áã¨ËÄÖ„ÄÇË™∞„Çà„ÇäÈùô„Åã„Å´„ÄÅË™∞„Çà„ÇäÊ∑±„ÅèÁáÉ„Åà„Çã„ÄÇ„Åù„ÅÆË≤¨‰ªªÊÑü„Å®ËëõËó§„ÅÆÊ∑±„Åï„Åå„ÄÅÊöóÈªíÈ®éÂ£´„ÅÆÁâ©Ë™û„Å®Èáç„Å™„Çä„Åæ„Åô„ÄÇ",
    traits:["Ë™†ÂÆü„Åï","Ë≤¨‰ªªÊÑü","ÂÜÖÁúÅÁöÑ","‰∏çÂ±à"], imgKey:"DarkKnight" },
  ESTP_TANK: { name:"Gunbreaker", nameJp:"„Ç¨„É≥„Éñ„É¨„Ç§„Ç´„Éº",icon:"üî´", color:"#c49a1a", role:"„Çø„É≥„ÇØ",
    desc:"ÁàÜÁô∫ÁöÑ„Å™ÂèçÂøúÈÄüÂ∫¶„Å®Èã≠„ÅÑÂà§Êñ≠Âäõ„ÇíÊåÅ„Å§Â≠§È´ò„ÅÆÂÆüË∑µËÄÖ„ÄÇË§áÈõë„Å™„Ç≥„É≥„Éú„ÇíÁÑ°Ë®Ä„Åß„Åì„Å™„Åô„Ç¨„É≥„Éñ„É¨„Ç§„Ç´„Éº„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„ÇØ„Éº„É´„Å™Áã¨Á´ãÂøÉ„Å®Âç≥ËààÂäõ„Çí‰ΩìÁèæ„Åó„Åæ„Åô„ÄÇ",
    traits:["Áû¨Áô∫Âäõ","Áã¨Á´ãÂøÉ","ÁèæÂÆüÊÄùËÄÉ","„Çπ„Çø„Ç§„É™„ÉÉ„Ç∑„É•"], imgKey:"Gunbreaker" },
  // ‚îÄ‚îÄ‚îÄ HEALER ‚îÄ‚îÄ‚îÄ
  ENFJ_HEALER: { name:"Astrologian", nameJp:"Âç†ÊòüË°ìÂ∏´",  icon:"‚≠ê", color:"#d4af37", role:"„Éí„Éº„É©„Éº",
    desc:"Êòü„ÅÆÂ∞é„Åç„Å®„Å®„ÇÇ„Å´‰ª≤Èñì„ÇíÁÖß„Çâ„Åô„Ç´„É™„Çπ„ÉûÁöÑ„Çµ„Éù„Éº„Çø„Éº„ÄÇÊúÄÈ´ò„ÅÆ„Çø„Ç§„Éü„É≥„Ç∞„Åß„Éê„Éï„ÇíÂ±ä„Åë„ÇãÂ§©ÊÄß„ÅÆÊîØÊè¥ËÄÖ„ÄÇ„ÅÇ„Å™„Åü„ÅÆÁõ¥ÊÑü„Å®ÂÖ±ÊÑüÂäõ„Åå„ÄÅÊòü„ÅÆÂäõ„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÂÖ±ÊÑüÂäõ","ÂÖàË¶ãÊÄß","„Ç´„É™„Çπ„Éû","ÁåÆË∫´"], imgKey:"Astrologian" },
  ESFJ_HEALER: { name:"White Mage", nameJp:"ÁôΩÈ≠îÈÅìÂ£´",   icon:"‚ú®", color:"#b8e0e0", role:"„Éí„Éº„É©„Éº",
    desc:"‰ª≤Èñì„ÇíÁîü„Åã„ÅóÁ∂ö„Åë„Çã„Åì„Å®„Å´ÂÖ®Âäõ„ÇíÊ≥®„ÅêÁ¥îÁ≤ã„Å™ÂÆàË≠∑ËÄÖ„ÄÇ„ÉÅ„Éº„É†„ÅåÁîü„Åç„Å¶„ÅÑ„ÇãÈôê„ÇäÊà¶„ÅÑ„ÅØÁ∂ö„Åè„ÄÇ„ÅÇ„Å™„Åü„ÅÆÂà©‰ªñ„ÅÆÂøÉ„ÅÆÁ¥îÁ≤ã„Å™Áô∫Èú≤„Åå„ÄÅÁôΩ„ÅÆÈ≠îÊ≥ï„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["Âà©‰ªñ‰∏ªÁæ©","Ë≤¨‰ªªÊÑü","Ê∏©„Åã„Åï","ÂÆüË°åÂäõ"], imgKey:"WhiteMage" },
  INFJ_HEALER: { name:"Scholar",    nameJp:"Â≠¶ËÄÖ",       icon:"üìö", color:"#4a8fb5", role:"„Éí„Éº„É©„Éº",
    desc:"„Éï„Çß„Ç¢„É™„Éº„ÇíÂæì„Åà„ÄÅÂÖàË™≠„Åø„Å®‰∫ãÂâçÈÖçÁΩÆ„ÅßÂë≥Êñπ„ÇíÂÆà„ÇãÊ¥ûÂØüËÄÖ„ÄÇË™∞„ÇÇÊ∞ó„Å•„ÅÑ„Å¶„ÅÑ„Å™„ÅÑÊú™Êù•„Å∏„ÅÆÂÇô„Åà„Å®„ÅÑ„ÅÜÊ∑±„ÅÑÂÖàË¶ãÊÄß„Å®‰ΩøÂëΩÊÑü„Åå„ÄÅÂ≠¶ËÄÖ„ÅÆÈùô„Åã„Å™Êà¶Áï•„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÂÖàË¶ãÊÄß","ÊÄù„ÅÑ„ÇÑ„Çä","Á∑ªÂØÜ„Åï","‰ΩøÂëΩÊÑü"], imgKey:"Scholar" },
  ISFJ_HEALER: { name:"Sage",       nameJp:"Ë≥¢ËÄÖ",       icon:"üíé", color:"#2a9a9a", role:"„Éí„Éº„É©„Éº",
    desc:"ÊîªÊíÉ„Åô„Çã„Åì„Å®„Åß‰ª≤Èñì„ÇíÁôí„Åô„ÄÅÈùô„Åã„Å™ÂÆàË≠∑„ÅÆÂì≤Â≠¶ËÄÖ„ÄÇÁ∏Å„ÅÆ‰∏ã„ÅßÊîØ„ÅàÁ∂ö„Åë„Çã„ÅÇ„Å™„Åü„ÅÆÂ•â‰ªï„ÅÆÁ≤æÁ•û„Å®ÊÖéÈáç„Å™ÊÄù„ÅÑ„ÇÑ„Çä„Åå„ÄÅË≥¢ËÄÖ„ÅÆÈùô„Åã„Å™Âäõ„Å®„Å™„Çä„Åæ„Åô„ÄÇ",
    traits:["Â•â‰ªïÁ≤æÁ•û","ÊÖéÈáç„Åï","Ê∏©„Åã„Åï","Èùô„Åã„Å™Âº∑„Åï"], imgKey:"Sage" },
  // ‚îÄ‚îÄ‚îÄ MDPSÔºàËøëÊé•Áâ©ÁêÜÔºâ‚îÄ‚îÄ‚îÄ
  ESTP_MDPS: { name:"Monk",        nameJp:"„É¢„É≥„ÇØ",      icon:"üëä", color:"#d4821a", role:"ËøëÊé•DPS",
    desc:"ÂúßÂÄíÁöÑ„Å™ÈÄ£ÊíÉÈÄüÂ∫¶„Å®Ë∫´‰Ωì„ÅÆÂãï„Åç„ÅßÊïµ„ÇíÂà∂„Åô„ÇãÊ†ºÈóòÂÆ∂„ÄÇÂàπÈÇ£„ÅÆÂà§Êñ≠„Å®‰Ωì„ÅÆÂèçÂøú„ÅßÁîü„Åç„Çã„É¢„É≥„ÇØ„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆÁàÜÁô∫ÁöÑ„Å™Ë°åÂãïÂäõ„Å®ÁèæÂÆü„Å∏„ÅÆÁõ¥ÊÑü„Çí‰ΩìÁèæ„Åó„Åæ„Åô„ÄÇ",
    traits:["Ë°åÂãïÂäõ","Áû¨Áô∫Âäõ","ÁèæÂÆüÊÄùËÄÉ","ËÇâ‰ΩìÊ¥æ"], imgKey:"Monk" },
  ISTP_MDPS: { name:"Ninja",       nameJp:"ÂøçËÄÖ",        icon:"üéå", color:"#3a9a6a", role:"ËøëÊé•DPS",
    desc:"ÂÜ∑Èùô„Å™ÂàÜÊûêÁúº„Å®Áû¨ÊôÇ„ÅÆÁä∂Ê≥ÅÂà§Êñ≠„ÅßËèØÈ∫ó„Å´Á´ã„Å°Âõû„ÇãÂÆüË∑µÂÆ∂„ÄÇË©¶Ë°åÈåØË™§„Åã„ÇâÊú¨Ë≥™„ÇíÊé¥„ÇÄ„ÇØ„Éº„É´„Å™Ë¶≥ÂØüÁúº„Å®Áã¨Á´ã„Åó„ÅüÂÆüË°åÂäõ„Åå„ÄÅÂøçËÄÖ„ÅÆÂç∞Ë°ì„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÂÆüË∑µÂäõ","ÂÜ∑Èùô„Åï","Âô®Áî®„Åï","Áã¨Á´ãÂøÉ"], imgKey:"Ninja" },
  ENTP_MDPS: { name:"Reaper",      nameJp:"„É™„Éº„Éë„Éº",    icon:"‚öîÔ∏è", color:"#8b4db5", role:"ËøëÊé•DPS",
    desc:"Ê≠ªÈúä„Å®„ÅÆÂ•ëÁ¥Ñ„Å®„ÅÑ„ÅÜÁï∞Á´Ø„ÅÆÂì≤Â≠¶„ÅßÊà¶Â†¥„Çí„Åã„Åç‰π±„ÅôËÄÖ„ÄÇÊó¢Â≠ò„ÅÆÊû†„ÇíÂ£ä„Åô„Åì„Å®„ÇíÊÅê„Çå„Å™„ÅÑ„ÅÇ„Å™„Åü„ÅÆÈù©Êñ∞ÊÄß„Å®Áü•ÁöÑÊé¢Ê±Ç„Åå„ÄÅ„É™„Éº„Éë„Éº„ÅÆÁ¶ç„ÄÖ„Åó„ÅÑÂäõ„Å®ÂÖ±È≥¥„Åó„Åæ„Åô„ÄÇ",
    traits:["Èù©Êñ∞ÊÄß","ÂûãÁ†¥„Çä","È†≠ËÑ≥Êà¶","ÂºÅË´ñÂÆ∂"], imgKey:"Reaper" },
  ESTJ_MDPS: { name:"Samurai",     nameJp:"‰æç",          icon:"‚õ©Ô∏è", color:"#c8602a", role:"ËøëÊé•DPS",
    desc:"ÂúßÂÄíÁöÑ„Å™Ââ£ÊäÄ„Å®Êè∫„Çã„Åé„Å™„ÅÑ‰ø°Âøµ„ÅßÈ†ÇÁÇπ„ÇíÁõÆÊåá„ÅôÊ±ÇÈÅìËÄÖ„ÄÇ‰æç„ÅÆÁ†î„ÅéÊæÑ„Åæ„Åï„Çå„Åü‰∏ÄÂàÄ„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆ„ÄåÊ•µ„ÇÅ„Çã„Åì„Å®„Å∏„ÅÆÂü∑ÁùÄ„Äç„Å®ÊåáÊèÆËÄÖÁöÑ„Å™Ëá™Â∑±ÂÆåÁµêÊÄß„ÇíÊò†„Åó„Åæ„Åô„ÄÇ",
    traits:["Ê±ÇÈÅìÁ≤æÁ•û","ÈõÜ‰∏≠Âäõ","Ê±∫Êñ≠Âäõ","Â≠§È´ò"], imgKey:"Samurai" },
  INFP_MDPS: { name:"Viper",       nameJp:"„É¥„Ç°„Ç§„Éë„Éº",  icon:"üêç", color:"#6abf69", role:"ËøëÊé•DPS",
    desc:"ÂèåÂâ£„ÇíÁ∏¶Ê®™ÁÑ°Â∞Ω„Å´Êìç„Çä„ÄÅÁã¨Ëá™„ÅÆ„É™„Ç∫„É†„ÅßÊà¶Â†¥„ÇíËàû„ÅÜ„ÄÇÊó¢ÊàêÊ¶ÇÂøµ„Å´„Å®„Çâ„Çè„Çå„Å™„ÅÑ„ÅÇ„Å™„Åü„ÅÆËá™Áî±„Å™ÊÑüÊÄß„Å®ÁêÜÊÉ≥‰∏ªÁæ©„Åå„ÄÅ„É¥„Ç°„Ç§„Éë„Éº„ÅÆ„Åó„Å™„ÇÑ„Åã„Å™Êà¶Èóò„Çπ„Çø„Ç§„É´„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["Ëá™Áî±Â•îÊîæ","ÊÑüÊÄß","Áã¨Ëá™„Çπ„Çø„Ç§„É´","ÁêÜÊÉ≥‰∏ªÁæ©"], imgKey:"Viper" },
  ISFP_MDPS: { name:"Dragoon",     nameJp:"Á´úÈ®éÂ£´",      icon:"üê≤", color:"#4169e1", role:"ËøëÊé•DPS",
    desc:"Â§©È´ò„ÅèË∑≥Ë∫ç„Åó„ÄÅÂ§ßÂú∞„ÇíË≤´„ÅèÊßç„ÇíÊåØ„Çã„ÅÜÁæéÂ≠¶„ÅÆ‰ΩìÁèæËÄÖ„ÄÇ„Åù„ÅÆÁû¨Èñì„ÅÆÁæé„Åó„Åï„Å∏„ÅÆ„Åì„Å†„Çè„Çä„Å®Áã¨Ëá™„ÅÆÊÑüÊÄß„Åå„ÄÅÁ´úÈ®éÂ£´„ÅÆÈ£õÁøî„Å®Èáç„Å™„Çä„Åæ„Åô„ÄÇ",
    traits:["Áã¨Ëá™ÊÄß","ÊÑüÊÄßË±ä„Åã","ÊäÄÂ∑ß","ÁæéÂ≠¶"], imgKey:"Dragoon" },
  // ‚îÄ‚îÄ‚îÄ RDPSÔºàÈÅ†ÈöîÁâ©ÁêÜÔºâ‚îÄ‚îÄ‚îÄ
  ESFP_RDPS: { name:"Bard",        nameJp:"ÂêüÈÅäË©©‰∫∫",    icon:"üéµ", color:"#7cba8a", role:"ÈÅ†ÈöîDPS",
    desc:"Ê≠å„Å®Áü¢„ÅßÂ†¥„ÇíÂΩ©„Çã„Ç®„É≥„Çø„Éº„ÉÜ„Ç§„Éä„Éº„ÄÇ„ÅÇ„Å™„Åü„ÅØ‰∫∫„ÅåÂñú„Å∂Áû¨Èñì„Å´Áîü„Åç„Åå„ÅÑ„ÇíÊÑü„Åò„ÄÅÊà¶Â†¥„ÇíÂäáÂ†¥„Å´Â§â„Åà„ÇãÂ§©Êâç„ÄÇÂêüÈÅäË©©‰∫∫„ÅÆ„É°„É≠„Éá„Ç£„Éº„ÅØ„Åù„ÅÆË°®ÁèæÂäõ„ÅÆÁµêÊô∂„Åß„Åô„ÄÇ",
    traits:["Á§æ‰∫§ÊÄß","Ë°®ÁèæÂäõ","ÈÅ©ÂøúÂäõ","Â≠òÂú®ÊÑü"], imgKey:"Bard" },
  ENFP_RDPS: { name:"Dancer",      nameJp:"Ë∏ä„ÇäÂ≠ê",      icon:"üíÉ", color:"#e87ca0", role:"ÈÅ†ÈöîDPS",
    desc:"Â†¥„ÅÆÁ©∫Ê∞ó„ÇíË™≠„Åø„ÄÅ„Éë„Éº„Éà„Éä„Éº„Å®„ÅÆÁµÜ„ÅßËºù„ÅèËá™Áî±„Å™Ë°®ÁèæËÄÖ„ÄÇ‰∫àÊ∏¨‰∏çËÉΩ„Å™Áæé„Åó„Åï„Åì„Åù„ÅåÊ≠¶Âô®„ÄÇ„ÅÇ„Å™„Åü„ÅÆË±ä„Åã„Å™ÊÑüÂèóÊÄß„Å®Ëá™Áô∫ÁöÑ„Å™„Ç®„Éç„É´„ÇÆ„Éº„ÅåË∏ä„ÇäÂ≠ê„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÂâµÈÄ†ÊÄß","Ëá™Áô∫ÊÄß","ÂÖ±ÊÑüÂäõ","ËèØ„ÇÑ„Åã„Åï"], imgKey:"Dancer" },
  ISTJ_RDPS: { name:"Machinist",   nameJp:"Ê©üÂ∑•Â£´",      icon:"‚öôÔ∏è", color:"#9a7a2a", role:"ÈÅ†ÈöîDPS",
    desc:"„Ç¨„Ç∏„Çß„ÉÉ„Éà„Å®„É≠„Éú„ÉÉ„Éà„ÇíËá™Áî±Ëá™Âú®„Å´Êìç„ÇãÁÑ°Âè£„Å™„Ç¢„Éº„ÉÜ„Ç£„Çπ„Éà„ÄÇËá™ÂàÜ„Å†„Åë„ÅÆÈÅìÂÖ∑„Å∏„ÅÆÊÑõÁùÄ„ÅØ„ÅÇ„Å™„Åü„ÅÆÁπäÁ¥∞„Å™ÊÑüÊÄß„Å®Áã¨Ëá™„Çπ„Çø„Ç§„É´„Å∏„ÅÆ„Åì„Å†„Çè„Çä„ÇíÊò†„Åó„Åæ„Åô„ÄÇ",
    traits:["Áã¨Ëá™ÊÄß","ÊÑüÊÄßË±ä„Åã","ÊüîËªüÊÄß","ÊäÄÂ∑ß"], imgKey:"Machinist" },
  // ‚îÄ‚îÄ‚îÄ CDPSÔºàÈ≠îÊ≥ï„Éª„Ç≠„É£„Çπ„Çø„ÉºÔºâ‚îÄ‚îÄ‚îÄ
  INTJ_CDPS: { name:"Summoner",    nameJp:"Âè¨ÂñöÂ£´",      icon:"üêâ", color:"#7a4fcf", role:"„Ç≠„É£„Çπ„Çø„Éº",
    desc:"ÂπªÁç£„ÇíÊà¶Áï•ÁöÑ„Å´‰Ωø„ÅÑÂàÜ„Åë„ÄÅÂ£ÆÂ§ß„Å™„Éì„Ç∏„Éß„É≥„ÅÆ„ÇÇ„Å®„Å´Êà¶„ÅÜÁü•„ÅÆÊîØÈÖçËÄÖ„ÄÇÂÖ®‰Ωì„ÇíË¶ãÈÄö„ÅôÁõÆ„Å®Èï∑ÊúüÁöÑË®àÁîªÊÄß„ÅåÂè¨ÂñöÂ£´„ÅÆÂäõ„ÅÆÊ∫ê„ÄÇÂ≠§È´ò„ÅÆÁü•Áï•ÂÆ∂„ÄÇ",
    traits:["Êà¶Áï•ÊÄùËÄÉ","Áã¨Á´ãÂøÉ","Ê¥ûÂØüÂäõ","ÂÆåÁíß‰∏ªÁæ©"], imgKey:"Summoner" },
  INTP_CDPS: { name:"Black Mage",  nameJp:"ÈªíÈ≠îÈÅìÂ£´",    icon:"üî•", color:"#5050c8", role:"„Ç≠„É£„Çπ„Çø„Éº",
    desc:"ÂÆöÁÇπË©†Âî±„Å®„ÅÑ„ÅÜÊ•µËá¥„Å∏„ÅÆ„Åì„Å†„Çè„Çä„ÄÇÂäπÁéá„Çà„ÇäÁúüÁêÜ„ÇíÊ±Ç„ÇÅ„Çã„ÅÇ„Å™„Åü„ÅÆ„Äå„Åü„Å†Á¥îÁ≤ã„Å´Ê•µ„ÇÅ„Åü„ÅÑ„Äç„Å®„ÅÑ„ÅÜÊé¢Ê±ÇÂøÉ„Åå„ÄÅÈªíÈ≠îÈÅìÂ£´„ÅÆÁ†¥Â£äÁöÑÁÅ´Âäõ„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["Êé¢Ê±ÇÂøÉ","Ë´ñÁêÜÊÄß","ÈõÜ‰∏≠Âäõ","Áã¨Ëá™Ë¶ñÁÇπ"], imgKey:"BlackMage" },
  INFP_CDPS: { name:"Red Mage",    nameJp:"Ëµ§È≠îÈÅìÂ£´",    icon:"‚öóÔ∏è", color:"#c04070", role:"„Ç≠„É£„Çπ„Çø„Éº",
    desc:"È≠îÊ≥ï„Å®Ââ£„Å®„ÅÑ„ÅÜÁõ∏Âèç„Åô„Çã„ÇÇ„ÅÆ„ÇíËûçÂêà„Åï„Åõ„ÅüÁêÜÊÉ≥‰∏ªÁæ©ËÄÖ„ÄÇÂØæÁ´ã„Åô„Çã„ÇÇ„ÅÆ„ÅÆ‰∏≠„Å´Áæé„ÇíË¶ã„Å§„Åë„Çã„ÅÇ„Å™„Åü„ÅÆË©©ÁöÑ„Å™ÂÜÖÈù¢‰∏ñÁïå„Åå„ÄÅËµ§È≠îÈÅìÂ£´„ÅÆÁôΩ„Å®Èªí„ÅÆÂùáË°°„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÁêÜÊÉ≥‰∏ªÁæ©","ÂùáË°°ÊÑüË¶ö","Áã¨ÂâµÊÄß","Ë™†ÂÆü„Åï"], imgKey:"RedMage" },
  ENTP_CDPS: { name:"Pictomancer", nameJp:"„Éî„ÇØ„Éà„Éû„É≥„Çµ„Éº",icon:"üé®", color:"#e06090", role:"„Ç≠„É£„Çπ„Çø„Éº",
    desc:"ÁµµÁîª„ÅÆÈ≠îÂäõ„ÅßÊà¶Â†¥„ÇíÂ°ó„ÇäÊõø„Åà„ÇãÂâµÈÄ†„ÅÆÁï∞Á´ØËÄÖ„ÄÇ„ÅÇ„Å™„Åü„ÅÆÂ∫ïÁü•„Çå„Å™„ÅÑÁô∫ÊÉ≥Âäõ„Å®„ÄåË™∞„ÇÇÊÄù„ÅÑ„Å§„Åã„Å™„ÅÑ„Åì„Å®„Çí„ÇÑ„Çã„Äç„Å®„ÅÑ„ÅÜË°ùÂãï„Åå„ÄÅ„Éî„ÇØ„Éà„Éû„É≥„Çµ„Éº„ÅÆÈ≠îÊ≥ïÁ≠Ü„Å´ÂÆø„Çä„Åæ„Åô„ÄÇ",
    traits:["ÂâµÈÄ†ÊÄß","Èù©Êñ∞ÊÄß","Ë°®ÁèæÂäõ","Ëá™Áî±"], imgKey:"Pictomancer" },
};

// MBTI„Çø„Ç§„Éó„ÅåÂêå„Åò„Åß„ÇÇ„É≠„Éº„É´„ÅåÈÅï„Åà„Å∞Âà•„Ç∏„Éß„Éñ
// „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂÑ™ÂÖàÈ†Ü‰Ωç„Éû„ÉÉ„ÉóÔºàÂêåMBTI„ÅßÂ∏åÊúõ„É≠„Éº„É´„Åå„Å™„ÅÑÂ†¥ÂêàÔºâ
const fallbackOrder = {
  TANK:   ['TANK','HEALER','MDPS','RDPS','CDPS'],
  HEALER: ['HEALER','TANK','CDPS','RDPS','MDPS'],
  MDPS:   ['MDPS','RDPS','CDPS','TANK','HEALER'],
  RDPS:   ['RDPS','MDPS','CDPS','HEALER','TANK'],
  CDPS:   ['CDPS','RDPS','MDPS','HEALER','TANK'],
};

// MBTIÁõ∏ÊÄß„Éû„ÉÉ„ÉóÔºàÁõ∏ÊÄßÁêÜË´ñ„Éô„Éº„Çπ: Ë£úÂÆå„ÉªÂèåÂØæ„ÉªÂêå‰∏Ä„Ç∞„É´„Éº„ÉóÔºâ
// ÂêÑMBTI„Å´ÂØæ„Åó„Å¶Áõ∏ÊÄß„ÅÆËâØ„ÅÑ3„Å§„ÅÆMBTI„Ç≠„Éº(jobMap„ÅÆ„Ç≠„Éº)„Å®‰∏ÄË®Ä„Ç≥„É°„É≥„Éà„ÇíÂÆöÁæ©
const compatMap = {
  // TANK
  ENTJ_TANK: [
    { key:'INFP_MDPS',  comment:'„ÅÇ„Å™„Åü„ÅÆÊåáÊèÆÂäõ„Åå„ÄÅ„É¥„Ç°„Ç§„Éë„Éº„ÅÆËá™Áî±„Å™Ââ£Ëàû„ÇíÂÆà„ÇãÁõæ„Å®„Å™„Çã„ÄÇÊ≠£ÂèçÂØæ„Å†„Åã„Çâ„Åì„ÅùÊúÄÂº∑„ÅÆ„Ç≥„É≥„Éì„ÄÇ' },
    { key:'INFP_CDPS',  comment:'ÁêÜÊÉ≥„ÇíË™û„ÇãËµ§È≠îÈÅìÂ£´„Å®„ÄÅ„Åù„Çå„ÇíÂÆüÁèæ„Åô„ÇãÊà¶Áï•ÂÆ∂„ÄÇÁôΩ„Å®Èªí„ÅÆÂùáË°°„Çí„Å®„ÇÇ„Å´ÂÆà„Çã„ÄÇ' },
    { key:'ENFJ_HEALER',comment:'„É™„Éº„ÉÄ„ÉºÂêåÂ£´„ÅÆÂÖ±È≥¥„ÄÇÂç†ÊòüË°ìÂ∏´„ÅÆÁõ¥ÊÑü„Åå„ÅÇ„Å™„Åü„ÅÆÊ±∫Êñ≠„ÇíÊòü„ÅßÂ∞é„ÅÑ„Å¶„Åè„Çå„Çã„ÄÇ' },
  ],
  ESTJ_TANK: [
    { key:'INFP_MDPS',  comment:'Ë¶èÂæã„Å®Ëá™Áî±„ÅÆË£úÂÆåÈñ¢‰øÇ„ÄÇ„ÅÇ„Å™„Åü„ÅÆÂÆâÂÆö„Åó„ÅüÈò≤Âæ°Á∑ö„Åå„É¥„Ç°„Ç§„Éë„Éº„ÅÆÂ•îÊîæ„Å™Êîª„ÇÅ„ÇíÊ¥ª„Åã„Åô„ÄÇ' },
    { key:'ISFP_MDPS',  comment:'ÁÑ°Âè£„Å™Á´úÈ®éÂ£´„ÅÆÁæéÂ≠¶„Çí„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂäõÂº∑„ÅÑÁõæ„ÅåÈùô„Åã„Å´ÊîØ„Åà„Çã„ÄÇË®ÄËëâ„ÅØ‰∏çË¶Å„ÄÇ' },
    { key:'ISFJ_HEALER',comment:'Â†ÖÂÆü„Å™ËÄÖÂêåÂ£´„ÅÆÊúÄÂº∑„Çø„ÉÉ„Ç∞„ÄÇË≥¢ËÄÖ„ÅÆÈùô„Åã„Å™ÂõûÂæ©„Åå„ÅÇ„Å™„Åü„ÅÆÁÑ°ÊïµÊÑü„Çí„Åï„Çâ„Å´È´ò„ÇÅ„Çã„ÄÇ' },
  ],
  ISTJ_TANK: [
    { key:'ENFP_RDPS',  comment:'Ë∏ä„ÇäÂ≠ê„ÅÆËèØ„ÇÑ„Åã„Åï„ÇíÂΩ±„ÅßÂÆà„ÇãÂΩ±„ÅÆÂÆàË≠∑ËÄÖ„ÄÇÊ≠£ÂèçÂØæ„ÅÆÂ≠òÂú®„Åå„Åä‰∫í„ÅÑ„ÇíÂÆåÊàê„Åï„Åõ„Çã„ÄÇ' },
    { key:'ESFP_RDPS',  comment:'ÂêüÈÅäË©©‰∫∫„ÅÆ„Éê„Éï„Åå„ÅÇ„Å™„Åü„ÅÆÂ†ÖÂÆü„Å™ÂÆà„Çä„Å´ÂΩ©„Çä„ÇíÊ∑ª„Åà„Çã„ÄÇÂΩ±„Å®ÂÖâ„ÅÆÂÖ±Êºî„ÄÇ' },
    { key:'ESTJ_MDPS',  comment:'Âêå„ÅòÂâ£„ÅÆÈÅì„ÇíÁï∞„Å™„ÇãÂì≤Â≠¶„ÅßÊ≠©„ÇÄËÄÖ„ÄÇ‰æç„ÅÆÈ´ò„Åø„Å∏„ÅÆÂü∑ÁùÄ„Åå„ÅÇ„Å™„Åü„ÅÆË≤¨‰ªªÊÑü„ÇíÈºìËàû„Åô„Çã„ÄÇ' },
  ],
  ESTP_TANK: [
    { key:'ENFJ_HEALER',comment:'Â≠§È´ò„ÅÆ„Ç¨„É≥„Éñ„É¨„Ç§„Ç´„Éº„Å´Âç†ÊòüË°ìÂ∏´„ÅÆÊòüÊòé„Åã„Çä„ÅåÈôç„ÇäÊ≥®„Åê„ÄÇË®ÄËëâÂ∞ë„Å™„Åè„Å®„ÇÇÊÅØ„ÅØÂêà„ÅÜ„ÄÇ' },
    { key:'ESFJ_HEALER',comment:'ÁôΩÈ≠îÈÅìÂ£´„ÅÆÊ∏©„Åã„ÅÑÂõûÂæ©„Åå„ÇØ„Éº„É´„Å™„ÅÇ„Å™„Åü„ÅÆËÉå‰∏≠„ÇíÁ¢∫„Åã„Å´ÂÆà„Å£„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'ESTP_MDPS',  comment:'Âêå„ÅòÁû¨Èñì„ÇíÁîü„Åç„ÇãÂÆüË∑µËÄÖÂêåÂ£´„ÄÇ„É¢„É≥„ÇØ„ÅÆÁàÜÁô∫Âäõ„Å®„ÅÇ„Å™„Åü„ÅÆÂà§Êñ≠Âäõ„ÅåÂ†¥„ÇíÊîØÈÖç„Åô„Çã„ÄÇ' },
  ],
  // HEALER
  ENFJ_HEALER: [
    { key:'ISTJ_TANK',  comment:'ÊöóÈªíÈ®éÂ£´„ÅÆÂ≠§Áã¨„Å™Ë≤¨‰ªªÊÑü„Çí„ÄÅ„ÅÇ„Å™„Åü„ÅÆÊòü„ÅÆÂÖâ„ÅåÁÖß„Çâ„ÅóÂ∞é„Åè„ÄÇÈùô„Åã„Å™ÁµÜ„ÄÇ' },
    { key:'ESTP_TANK',  comment:'„Ç¨„É≥„Éñ„É¨„Ç§„Ç´„Éº„ÅÆÁàÜÁô∫ÁöÑ„Å™Áõæ„ÇíÊîØ„Åà„Çã„Ç´„É™„Çπ„Éû„Éí„Éº„É©„Éº„ÄÇÁÑ°Ë®Ä„ÅÆ„Ç∑„Éä„Ç∏„Éº„ÅåÁîü„Åæ„Çå„Çã„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Âè¨ÂñöÂ£´„ÅÆÂÜ∑Âæπ„Å™Áü•Áï•„Å´„ÅÇ„Å™„Åü„ÅÆÊ∏©„Åã„ÅÑÂÖàË¶ãÊÄß„ÅåÂä†„Çè„Çã„Å®„ÄÅ„Éë„Éº„ÉÜ„Ç£„ÅåÂÆåÁíß„Å´„Å™„Çã„ÄÇ' },
  ],
  ESFJ_HEALER: [
    { key:'ISTJ_TANK',  comment:'Â†ÖÂÆü„Å™ÊöóÈªíÈ®éÂ£´„Å®„ÅÇ„Å™„Åü„ÅÆÊ∏©„Åã„Å™ÂõûÂæ©„ÅØ„ÄÅ„Åæ„Åï„Å´ÈâÑÂ£Å„ÅÆÂÆàË≠∑„Ç≥„É≥„Éì„ÄÇ' },
    { key:'ESTP_TANK',  comment:'ÁÑ°Âè£„Å™„Ç¨„É≥„Éñ„É¨„Ç§„Ç´„Éº„Çí„Åù„Å£„Å®ÊîØ„Åà„ÇãÊØçÊÄß„ÄÇÁõ∏Êâã„ÅØÁÑ°Ë®Ä„Åß„ÇÇÊÑüË¨ù„Åó„Å¶„ÅÑ„Çã„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Ë´ñÁêÜ„ÅÆÂè¨ÂñöÂ£´„Å´ÊÑüÊÉÖ„ÅÆÁôΩÈ≠îÈÅìÂ£´„ÄÇÂØæÊ•µ„ÅåË£ú„ÅÑÂêà„Å£„Å¶Âàù„ÇÅ„Å¶„Éë„Éº„ÉÜ„Ç£„ÅØÂÆåÊàê„Åô„Çã„ÄÇ' },
  ],
  INFJ_HEALER: [
    { key:'ESTP_MDPS',  comment:'„É¢„É≥„ÇØ„ÅÆË°ùÂãïÁöÑ„Å™Á™ÅÊíÉ„ÇíÂÖàË™≠„Åø„Åó„Å¶ÂÆà„Çå„Çã„ÅÆ„ÅØ„ÄÅÊú™Êù•„ÅåË¶ã„Åà„ÇãÂ≠¶ËÄÖ„Å†„Åë„ÄÇ' },
    { key:'ENTP_MDPS',  comment:'„É™„Éº„Éë„Éº„ÅÆ‰∫àÊ∏¨‰∏çËÉΩ„Å™Âãï„Åç„Çí„Åô„Åπ„Å¶ÂØüÁü•„Åô„Çã„ÅÆ„ÅåÂ≠¶ËÄÖ„ÅÆ‰ΩøÂëΩ„ÄÇÊ∑∑Ê≤å„ÇíÈùô„Åã„Å´Âà∂Âæ°„Åô„Çã„ÄÇ' },
    { key:'ENTJ_TANK',  comment:'„Éä„Ç§„Éà„ÅÆÂ§ßÂ±ÄÁöÑÊåáÊèÆ„Å®Â≠¶ËÄÖ„ÅÆÁ∑ªÂØÜ„Å™‰∫ãÂâçÊ∫ñÂÇô„ÅåÈáç„Å™„Çã„Å®ÁÑ°Êïµ„ÅÆ„É©„Ç§„É≥„ÅåÁîü„Åæ„Çå„Çã„ÄÇ' },
  ],
  ISFJ_HEALER: [
    { key:'ESTJ_TANK',  comment:'Êà¶Â£´„ÅÆË±™Âø´„Å™Ëá™ÂÇ∑ÂõûÂæ©„ÇíÊ∏©„Åã„Åè„Éï„Ç©„É≠„Éº„Åô„ÇãÈùô„Åã„Å™ÂÆàË≠∑ËÄÖ„ÄÇÁÑ°ÁêÜ„Åï„Åõ„Å™„ÅÑ„Çà„ÅÜË¶ãÂÆà„Çã„ÄÇ' },
    { key:'ENTJ_TANK',  comment:'„Éä„Ç§„Éà„ÅÆ‰ΩøÂëΩÊÑü„Å´Ë≥¢ËÄÖ„ÅÆÂ•â‰ªï„ÅÆÂøÉ„ÅåÈáç„Å™„Çã„ÄÇÂÆàË≠∑„Å®ÂõûÂæ©„ÅÆÁæé„Åó„ÅÑÈÄ£Èéñ„ÄÇ' },
    { key:'INTP_CDPS',  comment:'ÈªíÈ≠îÈÅìÂ£´„ÅÆËá™Áî±„Å™ÂÆöÁÇπË©†Âî±„ÇíË™∞„Çà„Çä‰∏äÊâã„Å´ÊîØ„Åà„Çâ„Çå„Çã„ÅÆ„ÅØ„ÄÅ„ÅÇ„Å™„Åü„ÅÆÊÖéÈáç„Å™ÂÖàË™≠„Åø„Å†„Åë„ÄÇ' },
  ],
  // MDPS
  ESTP_MDPS: [
    { key:'INFJ_HEALER',comment:'Â≠¶ËÄÖ„ÅÆÂÖàË™≠„Åø„Åå„ÅÇ„Å™„Åü„ÅÆÁ™ÅÈÄ≤„ÇíÂÆåÁíß„Å´„Ç´„Éê„Éº„ÄÇÊö¥„Çå„Çã„Åª„Å©„Å´ÂÆà„Çâ„Çå„Å¶„ÅÑ„Çã„ÄÇ' },
    { key:'ISFJ_HEALER',comment:'Ë≥¢ËÄÖ„ÅÆÈùô„Åã„Å™Ë¶ãÂÆà„Çä„Åå„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂÖ®Âäõ„ÉÄ„ÉÉ„Ç∑„É•„ÇíÂÆâÂøÉ„Å´Â§â„Åà„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Âè¨ÂñöÂ£´„ÅÆÂÜ∑Èùô„Å™Êà¶Áï•Áúº„Åå„ÅÇ„Å™„Åü„ÅÆÁàÜÁô∫ÁöÑDPS„ÇíÊúÄÂ§ßÈôê„Å´Ê¥ª„Åã„ÅôÈÖçÁΩÆ„Çí‰Ωú„Çã„ÄÇ' },
  ],
  ISTP_MDPS: [
    { key:'ENFJ_HEALER',comment:'Âç†ÊòüË°ìÂ∏´„ÅÆ„Ç´„É™„Çπ„Éû„Éê„Éï„Åå„ÄÅÂøçËÄÖ„ÅÆÁ≤æÂØÜ„Å™Á´ã„Å°Âõû„Çä„Çí„Åï„Çâ„Å´Ëºù„Åã„Åõ„Çã„ÄÇ' },
    { key:'ESFJ_HEALER',comment:'ÁôΩÈ≠îÈÅìÂ£´„ÅÆÂÆâÂÆö„Åó„ÅüÂõûÂæ©„Åå„ÅÇ„Å™„Åü„ÅÆÂ≠§È´ò„ÅÆÈõÜ‰∏≠„ÇíÈÄîÂàá„Çå„Åï„Åõ„Å™„ÅÑ„ÄÇ' },
    { key:'ENTP_CDPS',  comment:'„Éî„ÇØ„Éà„Éû„É≥„Çµ„Éº„ÅÆÂâçË°õËä∏Ë°ìÁöÑ„Å™ÊîªÊíÉ„Å®„ÅÇ„Å™„Åü„ÅÆ„ÇØ„Éº„É´„Å™ÂÆüË∑µÂäõ„ÅåÂ•áÂ¶ô„Å´Âôõ„ÅøÂêà„ÅÜ„ÄÇ' },
  ],
  ENTP_MDPS: [
    { key:'INFJ_HEALER',comment:'Â≠¶ËÄÖ„ÅÆÈùô„Åã„Å™Ë™≠„Åø„Åå„ÄÅ„É™„Éº„Éë„Éº„ÅÆÂûãÁ†¥„Çä„Å™Âãï„Åç„ÇíÈô∞„Åã„ÇâÂÆåÁíß„Å´Ë£ú‰Ωê„Åô„Çã„ÄÇ' },
    { key:'ISFJ_HEALER',comment:'Ë≥¢ËÄÖ„ÅÆÂøçËÄê„Å®Ê∏©„Åã„Åï„Åå„ÄÅ„ÅÇ„Å™„Åü„ÅÆÁ†¥Â§©Ëçí„Å™„Çπ„Çø„Ç§„É´„ÇíÊîØ„Åà„ÇãÁ∏Å„ÅÆ‰∏ã„ÅÆÊü±„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Âêå„Åò„ÄåÁü•„Äç„ÅÆ‰Ωø„ÅÑÊâã„Å®„Åó„Å¶ÂÖ±È≥¥„Åô„Çã„ÄÇÂè¨ÂñöÂ£´„ÅÆÊà¶Áï•„Å®„É™„Éº„Éë„Éº„ÅÆÊ∑∑‰π±„Åå‰∏ñÁïå„ÇíÊè∫„Çã„Åå„Åô„ÄÇ' },
  ],
  ESTJ_MDPS: [
    { key:'INFP_MDPS',  comment:'Â≠§È´ò„ÅÆ‰æç„Å®Â§¢Ë¶ã„Çã„É¥„Ç°„Ç§„Éë„Éº„ÄÇÊ±ÇÈÅìËÄÖ„Å®Ëá™Áî±‰∫∫„ÅÆÂØæÊØî„ÅåÊà¶Â†¥„Å´Ë©©„ÇíÁîü„ÇÄ„ÄÇ' },
    { key:'ISFP_MDPS',  comment:'Âêå„ÅòÂâ£„ÅÆÈÅì„Åß„ÇÇÁæéÂ≠¶„ÅåÈÅï„ÅÜ„ÄÇÁ´úÈ®éÂ£´„ÅÆÊÑüÊÄß„Åå‰æç„ÅÆÁ≤æÁ•û„ÇíË±ä„Åã„Å´„Åô„Çã„ÄÇ' },
    { key:'ENFJ_HEALER',comment:'Âç†ÊòüË°ìÂ∏´„ÅÆ„Ç´„É™„Çπ„Éû„Å®„ÅÇ„Å™„Åü„ÅÆÊ±∫Êñ≠Âäõ„ÅåÂêà„Çè„Åï„Çã„Å®„ÄÅ„Éë„Éº„ÉÜ„Ç£ÂÖ®‰Ωì„ÅåÂãï„ÅçÂá∫„Åô„ÄÇ' },
  ],
  INFP_MDPS: [
    { key:'ENTJ_TANK',  comment:'„Éä„Ç§„Éà„ÅÆÂº∑Âõ∫„Å™ÊåáÊèÆ„Åå„É¥„Ç°„Ç§„Éë„Éº„ÅÆËá™Áî±„Å™Ââ£Ëàû„ÇíÊúÄÂ§ßÈôê„Å´Ê¥ª„Åã„Åó„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'ESTJ_TANK',  comment:'Êà¶Â£´„ÅÆÊè∫„Çã„Åé„Å™„ÅÑÁõæ„Åå„ÅÇ„Å™„Åü„ÅÆÂ§¢„ÇíÁèæÂÆü„Å´Â§â„Åà„ÇãÂúüÂè∞„Å®„Å™„Çã„ÄÇ' },
    { key:'INFP_CDPS',  comment:'Âêå„ÅòÈ≠Ç„ÇíÊåÅ„Å§ËÄÖ„ÄÇËµ§È≠îÈÅìÂ£´„ÅÆÂùáË°°„Åô„ÇãÂì≤Â≠¶„Å®„É¥„Ç°„Ç§„Éë„Éº„ÅÆËá™Áî±„ÅåË©©ÁöÑ„Å´ÂÖ±È≥¥„Åô„Çã„ÄÇ' },
  ],
  ISFP_MDPS: [
    { key:'ESTJ_TANK',  comment:'ÁÑ°È™®„Å™Êà¶Â£´„Åå„ÅÇ„Å™„Åü„ÅÆÁπäÁ¥∞„Å™ÁæéÂ≠¶„ÇíÈªô„Å£„Å¶ÂÆà„ÇäÁ∂ö„Åë„Å¶„Åè„Çå„Çã„ÄÇË®ÄËëâ„ÅØ„ÅÑ„Çâ„Å™„ÅÑ„ÄÇ' },
    { key:'ESTJ_MDPS',  comment:'‰æç„ÅÆÂâõ„Å®„Éâ„É©„Ç∞„Éº„É≥„ÅÆÁæé„ÄÇÁï∞„Å™„ÇãÁæéÂ≠¶„ÅåÈ´ò„Åø„Åß‰∫§„Çè„ÇãÁû¨Èñì„ÇíÁõÆÊåá„ÅôÂêåÂøó„ÄÇ' },
    { key:'ISFJ_HEALER',comment:'Âêå„ÅòÂÜÖÁúÅÁöÑ„Å™È≠Ç„ÇíÊåÅ„Å§ÂÆà„ÇäÊâãÂêåÂ£´„ÄÇË≥¢ËÄÖ„ÅÆÈùô„Åã„Å™ÂõûÂæ©„Åå„ÅÇ„Å™„Åü„ÅÆÈ£õÁøî„ÇíÊîØ„Åà„Çã„ÄÇ' },
  ],
  // RDPS
  ESFP_RDPS: [
    { key:'ISTJ_TANK',  comment:'ÊöóÈªíÈ®éÂ£´„ÅÆÂΩ±„Åå„ÅÇ„Å™„Åü„ÅÆÊ≠å„Å´Ê∑±„Åø„Çí‰∏é„Åà„Çã„ÄÇÂÖâ„Å®Èóá„ÅÆÂÖ±Êºî„ÅåÊà¶Â†¥„ÇíËàûÂè∞„Å´Â§â„Åà„Çã„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Âè¨ÂñöÂ£´„ÅÆÂÜ∑Èùô„Å™Âè∏‰ª§„Åå„ÅÇ„Å™„Åü„ÅÆË°®ÁèæÂäõ„Å´ÊÑèÂë≥„Å®ÊñπÂêëÊÄß„Çí‰∏é„Åà„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'INFJ_HEALER',comment:'Â≠¶ËÄÖ„ÅÆÂÖàË™≠„Åø„Éê„É™„Ç¢„Åå„ÄÅÂêüÈÅäË©©‰∫∫„ÅÆËá™Áî±„Å™Âãï„ÅçÂõû„Çä„ÇíÂÆåÂÖ®„Å´„Ç´„Éê„Éº„Åô„Çã„ÄÇ' },
  ],
  ENFP_RDPS: [
    { key:'ISTJ_TANK',  comment:'ÊöóÈªíÈ®éÂ£´„ÅÆÈùô„Åã„Å™Ë™†ÂÆü„Åï„Åå„ÄÅË∏ä„ÇäÂ≠ê„ÅÆËèØ„ÇÑ„Åã„Åï„ÇíÂú∞„Å´Ë∂≥„Å§„Åã„Åõ„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'INTJ_CDPS',  comment:'Âè¨ÂñöÂ£´„ÅÆÁ∑ªÂØÜ„Å™Êà¶Áï•„Åå„ÉÄ„É≥„Çµ„Éº„ÅÆÁõ¥ÊÑüÁöÑ„Å™„Éë„Éº„Éà„Éä„ÉºÈÅ∏„Å≥„ÇíÂÆåÁíß„Å´Ê¥ª„Åã„Åô„ÄÇ' },
    { key:'INFJ_HEALER',comment:'Â≠¶ËÄÖ„ÅÆÊ∑±„ÅÑÊ¥ûÂØü„Åå„ÅÇ„Å™„Åü„ÅÆÂÖ±ÊÑüÂäõ„Å®ÂÖ±È≥¥„Åó„Å¶„ÄÅÊúÄÈ´ò„ÅÆ„Éí„Éº„É´ÔºÜ„Ç¢„Ç∑„Çπ„Éà„ÅåÁîü„Åæ„Çå„Çã„ÄÇ' },
  ],
  ISTJ_RDPS: [
    { key:'ESTJ_TANK',  comment:'Êà¶Â£´„ÅÆÂÆâÂÆö„Åó„ÅüÂ£Å„Åå„ÅÇ„Å™„Åü„ÅÆ„Ç¨„Ç∏„Çß„ÉÉ„ÉàÂ±ïÈñã„ÅÆËá™Áî±„Çí‰øùÈöú„Åó„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'ENFJ_HEALER',comment:'Âç†ÊòüË°ìÂ∏´„ÅÆÊòü„ÅÆ„Éê„Éï„ÅåÊ©üÂ∑•Â£´„ÅÆÁ≤æÂØÜ„Å™Â∞ÑÊíÉ„Çí„Åï„Çâ„Å´Ëºù„Åã„Åõ„Çã„ÄÇ' },
    { key:'INTP_CDPS',  comment:'ÈªíÈ≠îÈÅìÂ£´„ÅÆÊé¢Ê±ÇÂøÉ„Å®Ê©üÂ∑•Â£´„ÅÆÊäÄË°ìÊÑõ„Åå„ÄÅÁÑ°Ë®Ä„ÅÆ„ÉÜ„ÇØ„Éé„É≠„Ç∏„ÉºÂêåÁõü„ÇíÁµê„Å∂„ÄÇ' },
  ],
  // CDPS
  INTJ_CDPS: [
    { key:'ESFP_RDPS',  comment:'ÂêüÈÅäË©©‰∫∫„ÅÆË°®ÁèæÂäõ„ÅåÂè¨ÂñöÂ£´„ÅÆÂ≠§È´ò„ÅÆÊà¶Áï•„Å´ÂΩ©„Çä„ÇíÊ∑ª„Åà„Çã„ÄÇÁü•„Å®ÊÑüÊÄß„ÅÆÂÆåÁíß„Å™ËûçÂêà„ÄÇ' },
    { key:'ENFP_RDPS',  comment:'Ë∏ä„ÇäÂ≠ê„ÅÆÁõ¥ÊÑü„Å®Âè¨ÂñöÂ£´„ÅÆË®àÁÆó„ÅåÁµÑ„ÅøÂêà„Çè„Åï„Çã„Å®„ÄÅ‰∫àÊ∏¨‰∏çËÉΩ„Å™ÊúÄÂº∑„Éë„Éº„ÉÜ„Ç£„ÅåÁîü„Åæ„Çå„Çã„ÄÇ' },
    { key:'ESTP_MDPS',  comment:'„É¢„É≥„ÇØ„ÅÆÁàÜÁô∫Âäõ„ÇíÂè¨ÂñöÂ£´„ÅåÊà¶Áï•ÁöÑ„Å´ÈÖçÁΩÆ„Åô„Çã„ÄÇÁü•ÊÄß„ÅåËÇâ‰Ωì„ÇíÊúÄÂ§ßÈôê„Å´‰Ωø„ÅÜ„ÄÇ' },
  ],
  INTP_CDPS: [
    { key:'ESFJ_HEALER',comment:'ÁôΩÈ≠îÈÅìÂ£´„ÅÆÊ∏©„Åã„Åø„ÅåÈªíÈ≠îÈÅìÂ£´„ÅÆÂ≠§Áã¨„Å™Êé¢Ê±Ç„ÇíÈùô„Åã„Å´ÊîØ„Åà„Å¶„Åè„Çå„Çã„ÄÇ' },
    { key:'ISTJ_RDPS',  comment:'Ê©üÂ∑•Â£´„ÅÆÊäÄË°ìÊÑõ„Å®ÈªíÈ≠îÈÅìÂ£´„ÅÆÁêÜË´ñÊé¢Ê±Ç„ÄÇÁÑ°Ë®Ä„ÅßÂàÜ„Åã„ÇäÂêà„Åà„Çã„É¢„Éé„Å•„Åè„ÇäÂêåÁõü„ÄÇ' },
    { key:'ENFJ_HEALER',comment:'Âç†ÊòüË°ìÂ∏´„ÅÆ„Ç´„É™„Çπ„Éû„ÅåÈªíÈ≠îÈÅìÂ£´„ÅÆÂÆöÁÇπË©†Âî±„ÇíÂÆà„ÇãÊúÄÈ´ò„ÅÆÁí∞Â¢É„ÇíÊï¥„Åà„Å¶„Åè„Çå„Çã„ÄÇ' },
  ],
  INFP_CDPS: [
    { key:'ENTJ_TANK',  comment:'„Éä„Ç§„Éà„ÅÆÂº∑Âõ∫„Å™ÊÑèÂøó„ÅåËµ§È≠îÈÅìÂ£´„ÅÆÁêÜÊÉ≥‰∏ªÁæ©„ÇíÁèæÂÆü„Å´Âºï„ÅçÊàª„Åó„Å¶„Åè„Çå„Çã„ÄÇÊ≠£ÂèçÂØæ„ÅÆÂÆåÁíß„Å™Ë£úÂÆå„ÄÇ' },
    { key:'INFP_MDPS',  comment:'Âêå„ÅòÈ≠Ç„ÇíÊåÅ„Å§„É¥„Ç°„Ç§„Éë„Éº„Å®Ëµ§È≠îÈÅìÂ£´„ÄÇËá™Áî±„Å®ÂùáË°°„ÄÅ‰∫å„Å§„ÅÆË©©„ÅåÊà¶Â†¥„Å´Èüø„Åè„ÄÇ' },
    { key:'ISFJ_HEALER',comment:'Ë≥¢ËÄÖ„ÅÆÈùô„Åã„Å™Â•â‰ªï„Åå„ÅÇ„Å™„Åü„ÅÆÁêÜÊÉ≥„ÅÆ‰∏ñÁïå„ÇíÂÑ™„Åó„ÅèÂÆà„ÇäÁ∂ö„Åë„Å¶„Åè„Çå„Çã„ÄÇ' },
  ],
  ENTP_CDPS: [
    { key:'ISTP_MDPS',  comment:'ÂøçËÄÖ„ÅÆ„ÇØ„Éº„É´„Å™ÊäÄË°ì„Å®„Éî„ÇØ„Éà„Éû„É≥„Çµ„Éº„ÅÆÂ•îÊîæ„Å™Áô∫ÊÉ≥„ÅåÂ•áË∑°ÁöÑ„Å™„Ç≥„É≥„Éì„Éç„Éº„Ç∑„Éß„É≥„ÇíÁîü„ÇÄ„ÄÇ' },
    { key:'INFJ_HEALER',comment:'Â≠¶ËÄÖ„ÅÆÁ∑ªÂØÜ„Å™Ë™≠„Åø„Åå„ÅÇ„Å™„Åü„ÅÆ‰∫àÊ∏¨‰∏çËÉΩ„Å™ÊîªÊíÉ„Çí„Åô„Åπ„Å¶„Ç´„Éê„Éº„Åó„Å¶„Åè„Çå„ÇãÂîØ‰∏Ä„ÅÆÂ≠òÂú®„ÄÇ' },
    { key:'ISTJ_TANK',  comment:'ÊöóÈªíÈ®éÂ£´„ÅÆË≤¨‰ªªÊÑü„Å®„ÅÑ„ÅÜÂúüÂè∞„Åå„ÅÇ„Å£„Å¶Âàù„ÇÅ„Å¶„ÄÅ„Éî„ÇØ„Éà„Éû„É≥„Çµ„Éº„ÅØÊÄù„ÅÜÂ≠òÂàÜ„Ç≠„É£„É≥„Éê„Çπ„ÇíÊèè„Åë„Çã„ÄÇ' },
  ],
};

function renderCompat(jobKey) {
  const compats = compatMap[jobKey];
  if (!compats) return;
  const listEl = document.getElementById('compat-list');
  const roleColors = { „Çø„É≥„ÇØ:'#5b8dd9', „Éí„Éº„É©„Éº:'#7cba8a', 'ËøëÊé•DPS':'#c04b1a', 'ÈÅ†ÈöîDPS':'#c49a1a', „Ç≠„É£„Çπ„Çø„Éº:'#7a4fcf' };
  listEl.innerHTML = compats.map((c, i) => {
    const job = jobMap[c.key];
    if (!job) return '';
    const mbti = c.key.split('_')[0];
    const roleColor = roleColors[job.role] || '#c9a84c';
    const imgHtml = job.imgKey && JOB_IMAGES[job.imgKey]
      ? `<img class="compat-img" src="${JOB_IMAGES[job.imgKey]}" alt="${job.nameJp}">`
      : `<div class="compat-icon-fallback">${job.icon}</div>`;
    const rank = ['Best Match', 'Great Match', 'Good Match'][i];
    return `
      <div class="compat-card">
        <div class="compat-img-wrap">${imgHtml}</div>
        <div class="compat-info">
          <div class="compat-mbti">${mbti}</div>
          <div class="compat-name">${job.name}</div>
          <div class="compat-name-jp">${job.nameJp}</div>
          <div class="compat-comment">${c.comment}</div>
        </div>
        <div class="compat-badge" style="color:${roleColor};border-color:${roleColor};opacity:0.8">${rank}</div>
      </div>`;
  }).join('');
}


function hamming(a, b) {
  let d = 0;
  for (let i = 0; i < Math.min(a.length, b.length); i++) if (a[i] !== b[i]) d++;
  d += Math.abs(a.length - b.length);
  return d;
}

const roleDist = {
  TANK:   { TANK:0, HEALER:1, MDPS:2, RDPS:2, CDPS:3 },
  HEALER: { TANK:1, HEALER:0, MDPS:2, RDPS:1, CDPS:2 },
  MDPS:   { TANK:2, HEALER:2, MDPS:0, RDPS:1, CDPS:1 },
  RDPS:   { TANK:2, HEALER:1, MDPS:1, RDPS:0, CDPS:1 },
  CDPS:   { TANK:3, HEALER:2, MDPS:1, RDPS:1, CDPS:0 },
};

function findJob(mbti, role, axisScores) {
  // ÂêåMBTI„ÅßË§áÊï∞„É≠„Éº„É´„ÇíÊåÅ„Å§Â†¥Âêà„ÄÅ„É≠„Éº„É´„Çπ„Ç≥„Ç¢„ÅÆsoftmax„ÅßÊåØ„ÇäÂàÜ„Åë„Çã
  // (ISTP‚ÜíNinja/Gunbreaker, ENTJ‚ÜíPaladin/Samurai, ENTP‚ÜíReaper/Pictomancer)
  const mbtiRoles = Object.keys(jobMap)
    .filter(k => k.startsWith(mbti + '_'))
    .map(k => k.split('_')[1]);

  if (mbtiRoles.length === 1) {
    const r = mbtiRoles[0];
    return { job: jobMap[`${mbti}_${r}`], roleUsed: r };
  }

  if (mbtiRoles.length > 1 && axisScores) {
    const scores = determineRoleScores(axisScores);
    // „Åì„ÅÆMBTI„ÅåÊåÅ„Å§„É≠„Éº„É´„ÅÆ„Çπ„Ç≥„Ç¢„ÅßsoftmaxÔºàÊ∏©Â∫¶0.10Ôºâ
    const temp = 0.10;
    const vals = mbtiRoles.map(r => scores[r] ?? -999);
    const maxV = Math.max(...vals);
    const exps = vals.map(v => Math.exp((v - maxV) / temp));
    const total = exps.reduce((a, b) => a + b, 0);

    // Ê±∫ÂÆöÁöÑPRNG„Åß„Ç∑„Éº„ÉâÔºàÂêå„ÅòÂõûÁ≠î‚ÜíÂêå„ÅòÁµêÊûúÔºâ
    const seedStr = `${mbti}|${axisScores.EI.toFixed(4)}|${axisScores.SN.toFixed(4)}|${axisScores.TF.toFixed(4)}|${axisScores.JP.toFixed(4)}`;
    let h = 2166136261 >>> 0;
    for (let i = 0; i < seedStr.length; i++) {
      h ^= seedStr.charCodeAt(i);
      h = Math.imul(h, 16777619) >>> 0;
    }
    const rVal = ((h >>> 0) % 1000000) / 1000000.0 * total;
    let acc = 0;
    for (let i = 0; i < mbtiRoles.length; i++) {
      acc += exps[i];
      if (rVal <= acc) {
        const r = mbtiRoles[i];
        return { job: jobMap[`${mbti}_${r}`], roleUsed: r };
      }
    }
    const r = mbtiRoles[mbtiRoles.length - 1];
    return { job: jobMap[`${mbti}_${r}`], roleUsed: r };
  }

  // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „É≠„Éº„É´„Çπ„Ç≥„Ç¢È†Ü„Å´Êé¢Á¥¢
  const fallbackSearch = fallbackOrder[role] || Object.keys(fallbackOrder)[0];
  for (const r of fallbackSearch) {
    const key = `${mbti}_${r}`;
    if (jobMap[key]) return { job: jobMap[key], roleUsed: r };
  }

  // ÊúÄÁµÇ„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: HammingË∑ùÈõ¢
  const candidates = Object.keys(jobMap).map((k) => {
    const [t, r] = k.split('_');
    const dType = hamming(mbti, t);
    const dRole = (roleDist[role] && roleDist[role][r] != null) ? roleDist[role][r] : 3;
    return { key: k, r, score: dType * 10 + dRole };
  });
  let bestScore = Infinity;
  for (const c of candidates) bestScore = Math.min(bestScore, c.score);
  const best = candidates.filter(c => c.score === bestScore);
  const chosen = best[0];
  return { job: jobMap[chosen.key], roleUsed: chosen.r };
}

// ===== „É≠„Ç∏„ÉÉ„ÇØ =====
let currentQ = 0;
let axisScores = { EI: 0, SN: 0, TF: 0, JP: 0 };
let selectedVal = null;
let answerHistory = []; // Êàª„Çã„Éú„Çø„É≥Áî®ÔºöÂêÑÂïè„ÅÆÂõûÁ≠îÂÄ§„ÇíË®òÈå≤

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function startQuiz() {
  currentQ = 0;
  axisScores = { EI: 0, SN: 0, TF: 0, JP: 0 };
  selectedVal = null;
  answerHistory = [];
  showScreen('screen-quiz');
  renderQuestion();
}

function renderQuestion() {
  const q = questions[currentQ];
  selectedVal = null;

  const total = questions.length;
  document.getElementById('question-number').textContent = `Á¨¨ ${currentQ + 1} Âïè`;
  document.getElementById('progress-text').textContent = `Question ${currentQ + 1} / ${total}`;
  document.getElementById('progress-fill').style.width = `${((currentQ + 1) / total) * 100}%`;

  const card = document.getElementById('question-card');
  card.style.animation = 'none';
  card.offsetHeight;
  card.style.animation = 'fadeIn 0.4s ease';

  document.getElementById('question-text').textContent = q.text;

  const area = document.getElementById('scale-area');
  area.innerHTML = `
    <div class="scale-wrap">
      ${SCALE.map(s => `
        <div class="scale-row" data-val="${s.val}" onclick="selectScale(${s.val}, this)">
          <div class="scale-radio"></div>
          <div class="scale-label">${s.label}</div>
        </div>
      `).join('')}
    </div>
    <div style="display:flex;gap:12px;margin-top:8px;">
      ${currentQ > 0 ? `<button class="next-btn visible" id="back-btn" onclick="prevQuestion()" style="background:transparent;border:1px solid rgba(201,168,76,0.4);color:var(--gold);flex:0 0 auto;padding:12px 20px;">&larr; Êàª„Çã</button>` : ''}
      <button class="next-btn" id="next-btn" onclick="nextQuestion()" style="${currentQ > 0 ? 'flex:1;' : ''}">Ê¨°„Å∏ &rarr;</button>
    </div>
  `;
}

function selectScale(val, el) {
  selectedVal = val;
  document.querySelectorAll('.scale-row').forEach(r => r.classList.remove('selected'));
  el.classList.add('selected');
  document.getElementById('next-btn').classList.add('visible');
}

function nextQuestion() {
  if (selectedVal === null) return;
  // ÂõûÁ≠îÂ±•Ê≠¥„Å´‰øùÂ≠ò
  answerHistory.push(selectedVal);
  // 1Âïè1Ëª∏„ÉªÈÄÜËª¢È†ÖÁõÆÂØæÂøú„Çπ„Ç≥„Ç¢Âä†ÁÆó
  const q = questions[currentQ];
  const val = q.reversed ? -selectedVal : selectedVal;
  axisScores[q.axis] += val;
  currentQ++;
  if (currentQ < questions.length) {
    renderQuestion();
  } else {
    showResult();
  }
}

function prevQuestion() {
  if (currentQ <= 0) return;
  currentQ--;
  // Ââç„ÅÆÂõûÁ≠î„ÇíÂèñ„ÇäÂá∫„Åó„Å¶„Çπ„Ç≥„Ç¢„ÇíÂ∑ª„ÅçÊàª„Åô
  const prevVal = answerHistory.pop();
  const q = questions[currentQ];
  const prevValAdjusted = q.reversed ? -prevVal : prevVal;
  axisScores[q.axis] -= prevValAdjusted;
  renderQuestion();
  // ÂâçÂõû„ÅÆÈÅ∏Êäû„ÇíÂæ©ÂÖÉË°®Á§∫
  setTimeout(() => {
    const row = document.querySelector(`.scale-row[data-val="${prevVal}"]`);
    if (row) {
      selectedVal = prevVal;
      row.classList.add('selected');
      document.getElementById('next-btn').classList.add('visible');
    }
  }, 50);
}

function showResult() {
  showScreen('screen-loading');
  setTimeout(() => {
    const mbti =
      (axisScores.EI >= 0 ? 'E' : 'I') +
      (axisScores.SN >= 0 ? 'S' : 'N') +
      (axisScores.TF >= 0 ? 'T' : 'F') +
      (axisScores.JP >= 0 ? 'J' : 'P');

    const role = determineRole(axisScores);
    const picked = findJob(mbti, role, axisScores);
    const job = picked.job;
    const roleUsed = picked.roleUsed;
// „Ç∏„Éß„Éñ„Ç¢„Éº„ÉàÁîªÂÉè
    const imgKey = job.imgKey;
    const iconEl = document.getElementById('result-icon');
    if (imgKey && JOB_IMAGES[imgKey]) {
      const imagePositions = { Reaper: 'top center' };
      const pos = imagePositions[imgKey] || 'top center';
      iconEl.innerHTML = `<img class="result-job-art" src="${JOB_IMAGES[imgKey]}" alt="${job.nameJp}" style="object-position:${pos}">`;
    } else {
      iconEl.style.fontSize = '120px';
      iconEl.style.display = 'block';
      iconEl.style.padding = '40px 0';
      iconEl.textContent = job.icon;
    }
    document.getElementById('result-mbti').textContent = mbti;
    document.getElementById('result-job-name').textContent = job.name;
    document.getElementById('result-job-name-jp').textContent = job.nameJp;
    document.getElementById('result-desc').textContent = job.desc;

    // „É≠„Éº„É´„Éê„ÉÉ„Ç∏Ë°®Á§∫
    const roleColors = { „Çø„É≥„ÇØ:'#5b8dd9', „Éí„Éº„É©„Éº:'#7cba8a', 'ËøëÊé•DPS':'#c04b1a', 'ÈÅ†ÈöîDPS':'#c49a1a', „Ç≠„É£„Çπ„Çø„Éº:'#7a4fcf' };
    const roleEl = document.getElementById('result-job-name-jp');
    roleEl.innerHTML = `${job.nameJp} &nbsp;<span style="font-size:11px;padding:3px 10px;border:1px solid ${roleColors[job.role]||'#c9a84c'};color:${roleColors[job.role]||'#c9a84c'};font-family:'Cinzel',serif;letter-spacing:2px;">${job.role}</span>`;

    document.getElementById('result-traits').innerHTML =
      job.traits.map(t => `<span class="trait">${t}</span>`).join('');

    // „Çπ„Ç≥„Ç¢„Éê„ÉºÔºàMBTI 4Ëª∏Ôºâ
    const barsEl = document.getElementById('score-bars');
    const axes = [
      { label:['Â§ñÂêë (E)','ÂÜÖÂêë (I)'],   axis:'EI', colorL:'#e87ca0', colorR:'#7a4fcf' },
      { label:['ÊÑüË¶ö (S)','Áõ¥ÊÑü (N)'],   axis:'SN', colorL:'#7cba8a', colorR:'#5b8dd9' },
      { label:['ÊÄùËÄÉ (T)','ÊÑüÊÉÖ (F)'],   axis:'TF', colorL:'#c04b1a', colorR:'#d4af37' },
      { label:['Âà§Êñ≠ (J)','Áü•Ë¶ö (P)'],   axis:'JP', colorL:'#4a8fb5', colorR:'#8b4db5' },
    ];
    barsEl.innerHTML = axes.map(ax => {
      // ÂêÑËª∏„ÅÆÊúÄÂ§ßÂà∞ÈÅî„Çπ„Ç≥„Ç¢„ÇíÈáç„Åø„Åã„ÇâÂãïÁöÑË®àÁÆó
      const maxScore = questions.filter(q => q.axis === ax.axis).length * 3;
      const raw = axisScores[ax.axis];
      // ‰∏≠ÂøÉ(0)„Çí50%„Å®„Åó„Å¶Â∑¶Âè≥„Å´ÊåØ„Çã
      const halfPct = maxScore > 0 ? Math.round((Math.abs(raw) / maxScore) * 50) : 0;
      const isLeft = raw >= 0; // E/S/T/JÂÅ¥
      const fillStart = isLeft ? 50 : (50 - halfPct);
      const fillWidth = halfPct;
      const color = isLeft ? ax.colorL : ax.colorR;
      const pctDisplay = maxScore > 0 ? Math.round((Math.abs(raw) / maxScore) * 100) : 0;
      return `
        <div class="score-bar">
          <div class="score-label"><span>${ax.label[0]}</span><span>${ax.label[1]}</span></div>
          <div class="score-track" style="position:relative;">
            <div class="score-fill" style="position:absolute;left:${fillStart}%;width:${fillWidth}%;background:${color};height:100%;border-radius:3px;transition:width 1s ease 0.5s;"></div>
            <div style="position:absolute;left:50%;top:-2px;width:2px;height:10px;background:rgba(255,255,255,0.25);transform:translateX(-50%);"></div>
          </div>
          <div style="display:flex;justify-content:${isLeft ? 'flex-start' : 'flex-end'};font-size:11px;color:${color};margin-top:3px;padding:0 2px;opacity:0.8;">${pctDisplay}%</div>
        </div>`;
    }).join('') + `
      <div class="role-chart" id="role-chart-area"></div>`;
    // „É≠„Éº„É´„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÊèèÁîª
    drawRoleChart(roleUsed, axisScores);

    // Áõ∏ÊÄß„Ç∏„Éß„Éñ
    const jobKey = Object.keys(jobMap).find(k => jobMap[k] === job);
    renderCompat(jobKey);

    // „Ç∑„Çß„Ç¢„ÉÜ„Ç≠„Çπ„ÉàÔºàÁõ∏ÊÄß„Ç∏„Éß„ÉñÂèñÂæóÂæå„Å´ÁîüÊàêÔºâ
    const compats = compatMap[jobKey] || [];
    const compatNames = compats
      .map(c => jobMap[c.key]?.nameJp)
      .filter(Boolean)
      .slice(0, 3)
      .join(' / ');
    const siteUrl = 'https://panakuro.github.io/xiv21personality/';
    const shareText = encodeURIComponent(
      `FF14„Ç∏„Éß„ÉñÊÄßÊ†ºË®∫Êñ≠ÁµêÊûúÔºö${job.nameJp}„Äå${job.traits.join(' / ')}„Äç
` +
      `${job.nameJp}„Å®Áõ∏ÊÄß„ÅÆ„ÅÑ„ÅÑ„Ç∏„Éß„Éñ„ÅØÔºö${compatNames}
` +
      `${siteUrl}

` +
      `#FF14 #„Ç∏„Éß„ÉñË®∫Êñ≠ #„ÅÇ„Éº„Å®„ÅÆÊöá„Å§„Å∂„ÅóÂà∂‰Ωú`
    );
    document.getElementById('share-btn').href = `https://twitter.com/intent/tweet?text=${shareText}`;

    showScreen('screen-result');

    // ÈõÜË®à„Éá„Éº„Çø„ÇíGoogle Sheets„Å´ÈÄÅ‰ø°ÔºàÂ§±Êïó„Åó„Å¶„ÇÇË®∫Êñ≠„Å´„ÅØÂΩ±Èüø„Åó„Å™„ÅÑÔºâ
    sendResult({ job: job.name, jobJp: job.nameJp, mbti, role: roleUsed });
  }, 2000);
}

function sendResult(data) {
  const GAS_URL = 'https://script.google.com/macros/s/AKfycbwHxG-LMQr7he39jHvXUkEms9xlj1bIkLfVMtUWJXztEphDyNalmp0iOJVr5eG3l-pa2g/exec';
  fetch(GAS_URL, {
    method: 'POST',
    mode: 'no-cors', // CORS„Ç®„É©„Éº„ÇíÂõûÈÅøÔºàGAS„ÅÆ‰ªïÊßòÔºâ
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data),
  }).catch(() => {}); // Â§±Êïó„Åó„Å¶„ÇÇÁÑ°Ë¶ñ
}


function drawRoleChart(role, axisScores) {
  const roleNames  = ['TANK','HEALER','MDPS','RDPS','CDPS'];
  const roleJp     = { TANK:'„Çø„É≥„ÇØ', HEALER:'„Éí„Éº„É©„Éº', MDPS:'ËøëÊé•DPS', RDPS:'ÈÅ†ÈöîDPS', CDPS:'„Ç≠„É£„Çπ„Çø„Éº' };
  const roleColors = { TANK:'#5b8dd9', HEALER:'#7cba8a', MDPS:'#c04b1a', RDPS:'#c49a1a', CDPS:'#7a4fcf' };

  // determineRole„Å®Âêå„ÅòÈáç„Åø‰ªò„Åç„Çπ„Ç≥„Ç¢„Çí„ÉÅ„É£„Éº„Éà„Å´„ÇÇ‰ΩøÁî®
  const ei = axisScores.EI, tf = axisScores.TF, sn = axisScores.SN, jp = axisScores.JP;
  const raw = {
    TANK:   ei * 0.6 + tf * 0.5 + jp * 0.4,
    HEALER: ei * 0.4 - tf * 0.6 + jp * 0.3,
    MDPS:   tf * 0.4 + sn * 0.5 - jp * 0.2,
    RDPS:  -ei * 0.3 - tf * 0.3 + sn * 0.3 - jp * 0.2,
    CDPS:  -ei * 0.5 - sn * 0.6 - jp * 0.2,
  };

  // ÂÖ®„É≠„Éº„É´„Çí0‰ª•‰∏ä„Å´„Ç∑„Éï„Éà„Åó„Å¶Ê≠£Ë¶èÂåñ
  const minVal = Math.min(...Object.values(raw));
  const shifted = {};
  roleNames.forEach(rn => { shifted[rn] = raw[rn] - minVal + 0.1; });
  // Âá∫„Åü„Ç∏„Éß„Éñ„ÅÆ„É≠„Éº„É´„ÇíÂøÖ„ÅöMAX„Å´„Åô„Çã
  shifted[role] = Math.max(...Object.values(shifted)) * 1.01;
  const maxVal = Math.max(...Object.values(shifted));
  const normalized = {};
  roleNames.forEach(rn => { normalized[rn] = shifted[rn] / maxVal; });

  // SVG‰∫îËßíÂΩ¢„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà
  const cx = 130, cy = 135, r = 85;
  const angles = [-90, -90+72, -90+144, -90+216, -90+288].map(d => d * Math.PI / 180);

  function pt(i, radius) {
    return [cx + radius * Math.cos(angles[i]), cy + radius * Math.sin(angles[i])];
  }

  // „Ç∞„É™„ÉÉ„Éâ
  let gridLines = '';
  [0.25, 0.5, 0.75, 1.0].forEach(scale => {
    const pts = roleNames.map((_, i) => pt(i, r * scale).join(',')).join(' ');
    gridLines += `<polygon points="${pts}" fill="none" stroke="rgba(201,168,76,0.12)" stroke-width="1"/>`;
  });

  // Ëª∏Á∑ö
  const axisLines = roleNames.map((_, i) => {
    const [x, y] = pt(i, r);
    return `<line x1="${cx}" y1="${cy}" x2="${x}" y2="${y}" stroke="rgba(201,168,76,0.15)" stroke-width="1"/>`;
  }).join('');

  // „Éá„Éº„Çø„Éù„É™„Ç¥„É≥
  const dataPoints = roleNames.map((rn, i) => pt(i, r * normalized[rn]).join(','));
  const dataPoly = `<polygon points="${dataPoints.join(' ')}" fill="rgba(201,168,76,0.18)" stroke="#c9a84c" stroke-width="2"/>`;

  // „Éâ„ÉÉ„Éà
  const dots = roleNames.map((rn, i) => {
    const [x, y] = pt(i, r * normalized[rn]);
    const isActive = rn === role;
    return `<circle cx="${x}" cy="${y}" r="${isActive ? 7 : 4}"
      fill="${isActive ? roleColors[rn] : '#c9a84c'}"
      opacity="${isActive ? 1 : 0.7}"
      ${isActive ? 'filter="url(#glow)"' : ''}/>`;
  }).join('');

  // „É©„Éô„É´
  const labels = roleNames.map((rn, i) => {
    const [x, y] = pt(i, r + 24);
    const isActive = rn === role;
    return `<text x="${x}" y="${y}" text-anchor="middle" dominant-baseline="middle"
      font-family="Noto Serif JP, serif"
      font-size="${isActive ? 13 : 11}"
      fill="${isActive ? roleColors[rn] : 'rgba(232,223,200,0.45)'}"
      font-weight="${isActive ? 'bold' : 'normal'}">${roleJp[rn]}</text>`;
  }).join('');

  const svg = `
    <svg class="role-pentagon" width="270" height="280" viewBox="0 0 270 280">
      <defs>
        <filter id="glow">
          <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
          <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
        </filter>
      </defs>
      ${gridLines}${axisLines}${dataPoly}${dots}${labels}
    </svg>`;

  const el = document.getElementById('role-chart-area');
  if (el) {
    el.innerHTML = `<div class="role-chart-title">Role Tendency</div>${svg}`;
  }
}

function restartQuiz() {
  startQuiz();
}

// Stars
function createStars() {
  const container = document.getElementById('stars');
  for (let i = 0; i < 80; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.cssText = `
      left: ${Math.random() * 100}%;
      top: ${Math.random() * 100}%;
      --dur: ${2 + Math.random() * 4}s;
      --op: ${0.2 + Math.random() * 0.6};
      animation-delay: ${Math.random() * 4}s;
    `;
    container.appendChild(star);
  }
}

createStars();
</script>

<script>
/* ===== Debug harness (dev only) ===== */
(function(){
  'use strict';
  function getParams(){
    // Robust for file:// URLs on Chrome/Windows
    return new URLSearchParams(window.location.search || '');
  }
  function isDebug(){
    const p=getParams();
    return p.get('debug')==='1' || p.get('debug')==='true';
  }
  function isAutorun(){
    const p=getParams();
    return p.get('autorun')==='1' || p.get('autorun')==='true';
  }

  function randChoice(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

  // Detect the scale values from the UI definition (fallback to [-2,-1,0,1,2])
  function getScaleValues(){
    // If the page defines SCALE_CHOICES or similar, try to use it.
    if (window.SCALE_CHOICES && Array.isArray(window.SCALE_CHOICES)) {
      const vals = window.SCALE_CHOICES.map(x=>x.value).filter(v=>typeof v==='number');
      if (vals.length) return vals;
    }
    return [-2,-1,0,1,2];
  }

  function computeMBTIFromScores(scores){
    return (scores.EI >= 0 ? 'E':'I') +
           (scores.SN >= 0 ? 'S':'N') +
           (scores.TF >= 0 ? 'T':'F') +
           (scores.JP >= 0 ? 'J':'P');
  }

  function simulateOnce(scaleValues){
    // relies on globals defined in the main script: questions, determineRole, findJob
    const scores = { EI:0, SN:0, TF:0, JP:0 };
    for (let i=0;i<window.questions.length;i++){
      const q = window.questions[i];
      const v = randChoice(scaleValues);
      scores[q.axis] += v;
    }
    const mbti = computeMBTIFromScores(scores);
    const role = window.determineRole(scores);
    const picked = window.findJob(mbti, role, axisScores);
    const job = picked.job;
    const roleUsed = picked.roleUsed;
    // Use a stable key for counting: the jobMap key if possible
    const key = `${mbti}_${roleUsed}`;
    return { key, mbti, roleRequested: role, roleUsed, jobName: job.name, jobNameJp: job.nameJp };
  }

  function toCsv(rows){
    const header = ['rank','count','pct','jobName','jobNameJp','exampleKey','roleUsed','mbtiHint'];
    const lines = [header.join(',')];
    rows.forEach((r, idx)=>{
      const line = [
        idx+1,
        r.count,
        (r.pct).toFixed(2),
        `"${String(r.jobName).replaceAll('"','""')}"`,
        `"${String(r.jobNameJp).replaceAll('"','""')}"`,
        `"${String(r.exampleKey).replaceAll('"','""')}"`,
        r.roleUsed,
        r.mbtiHint
      ].join(',');
      lines.push(line);
    });
    return lines.join('\n');
  }

  function download(filename, text){
    const blob = new Blob([text], {type:'text/csv;charset=utf-8'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 0);
  }

  function renderDebugPanel(summary, n, meta){
    // create panel under intro card
    const introCard = document.querySelector('#screen-intro .intro-card');
    if (!introCard) return;

    let panel = document.getElementById('debug-panel');
    if (!panel){
      panel = document.createElement('div');
      panel.id = 'debug-panel';
      panel.style.marginTop = '18px';
      panel.style.textAlign = 'left';
      panel.style.padding = '16px';
      panel.style.border = '1px solid rgba(201,168,76,0.25)';
      panel.style.background = 'rgba(201,168,76,0.04)';
      panel.style.fontSize = '12px';
      panel.style.lineHeight = '1.7';
      introCard.appendChild(panel);
    }

    const top = summary.slice(0, 21);
    const missing = meta.expectedKeys.filter(k=>!meta.seenKeys.has(k));

    const rowsHtml = top.map((r, idx)=>`
      <tr>
        <td style="padding:6px 8px;opacity:.75">${idx+1}</td>
        <td style="padding:6px 8px">${r.jobNameJp} <span style="opacity:.6">(${r.jobName})</span></td>
        <td style="padding:6px 8px">${r.roleUsed}</td>
        <td style="padding:6px 8px;text-align:right">${r.count}</td>
        <td style="padding:6px 8px;text-align:right">${r.pct.toFixed(2)}%</td>
        <td style="padding:6px 8px;opacity:.7">${r.exampleKey}</td>
      </tr>
    `).join('');

    panel.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:10px">
        <div style="font-family:'Cinzel',serif;letter-spacing:2px;color:var(--gold)">DEBUG RESULTS</div>
        <div style="opacity:.75">N=${n.toLocaleString()}</div>
        <button id="debug-download" style="margin-left:auto;padding:6px 10px;border:1px solid rgba(201,168,76,0.35);background:transparent;color:var(--gold);cursor:pointer;font-family:'Cinzel',serif;letter-spacing:2px;font-size:10px">
          CSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        </button>
      </div>

      <div style="opacity:.85;margin-bottom:10px">
        ÊúüÂæÖ„Ç≠„ÉºÊï∞: ${meta.expectedKeys.length} / Ë¶≥Ê∏¨„Ç≠„ÉºÊï∞: ${meta.seenKeys.size}
        ${missing.length ? `<br><span style="color:rgba(255,200,200,.9)">Êú™Âá∫Áèæ„Ç≠„Éº: ${missing.join(', ')}</span>` : `<br><span style="color:rgba(180,255,200,.9)">Êú™Âá∫Áèæ„Ç≠„Éº„Å™„ÅóÔºàÂà∞ÈÅîÊÄßOKÔºâ</span>`}
      </div>

      <div style="overflow:auto;border:1px solid rgba(255,255,255,0.08);border-radius:3px">
        <table style="width:100%;border-collapse:collapse;min-width:640px">
          <thead>
            <tr style="background:rgba(0,0,0,0.25)">
              <th style="padding:8px 8px;text-align:left">#</th>
              <th style="padding:8px 8px;text-align:left">Job</th>
              <th style="padding:8px 8px;text-align:left">RoleUsed</th>
              <th style="padding:8px 8px;text-align:right">Count</th>
              <th style="padding:8px 8px;text-align:right">%</th>
              <th style="padding:8px 8px;text-align:left">Example Key</th>
            </tr>
          </thead>
          <tbody>${rowsHtml}</tbody>
        </table>
      </div>
      <div style="margin-top:10px;opacity:.7">
        ‚Äª „Åì„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÅØ„ÄåÂêÑË®≠Âïè„Åß -2,-1,0,1,2 „ÇíÁ≠âÁ¢∫Áéá„ÅßÈÅ∏„Å∂„Äç‰π±Êäû„Åß„ÅôÔºà„É¶„Éº„Ç∂„ÉºÂàÜÂ∏É„ÅØÊú™ÂèçÊò†Ôºâ„ÄÇ
      </div>
    `;

    const btn = document.getElementById('debug-download');
    if (btn){
      btn.onclick = () => download('ff14-job-quiz_debug_counts.csv', toCsv(summary));
    }
  }

  // public
  window.runDebugSimulation = async function runDebugSimulation(){
    const n = 10000;
    const scaleValues = getScaleValues();

    const btn = document.getElementById('debug-btn');
    const status = document.getElementById('debug-status');

    if (btn){ btn.disabled = true; btn.style.opacity = '0.7'; btn.textContent = 'ÂÆüË°å‰∏≠...'; }
    if (status){ status.style.display='block'; status.textContent = 'debug=ON  search=' + window.location.search + ' / running... 0%'; }

    // Let the browser paint the "running" state before heavy work
    await new Promise(r => setTimeout(r, 0));

    const counts = new Map(); // jobName -> {count, jobNameJp, roleUsed, exampleKey, mbtiHint}
    const seenKeys = new Set();

    // expected keys = jobMap keys (these are the "21ÈÄö„Çä" etc.)
    const expectedKeys = Object.keys(window.jobMap || {});

    const chunk = 250; // yield every N iterations so UI stays responsive
    for (let i=0;i<n;i++){
      const r = simulateOnce(scaleValues);
      seenKeys.add(r.key);

      const k = r.jobName; // count by final job (what user sees)
      const prev = counts.get(k);
      if (prev){
        prev.count += 1;
      } else {
        counts.set(k, { count: 1, jobName: r.jobName, jobNameJp: r.jobNameJp, roleUsed: r.roleUsed, exampleKey: r.key, mbtiHint: r.mbti });
      }

      if ((i+1) % chunk === 0){
        if (status){
          const pct = Math.floor(((i+1)/n) * 100);
          status.textContent = 'debug=ON  search=' + window.location.search + ' / running... ' + pct + '%';
        }
        // yield to UI thread
        await new Promise(r => setTimeout(r, 0));
      }
    }

    const summary = Array.from(counts.values())
      .map(x => ({...x, pct: (x.count / n) * 100}))
      .sort((a,b)=>b.count-a.count);

    renderDebugPanel(summary, n, { expectedKeys, seenKeys });

    if (status){
      status.textContent = 'debug=ON  search=' + window.location.search + ' / done ‚úÖ';
    }
    if (btn){
      btn.disabled = false;
      btn.style.opacity = '';
      btn.textContent = '„Éá„Éê„ÉÉ„Ç∞Ôºö„É©„É≥„ÉÄ„É†10,000Âõû';
    }
  };

  // Activate debug UI if requested
  document.addEventListener('DOMContentLoaded', () => {
    if (!isDebug()) return;
    const btn = document.getElementById('debug-btn');
    if (btn) btn.style.display = 'inline-block';
    const dbg=document.getElementById('debug-status');
    if(dbg){ dbg.style.display='block'; dbg.textContent = 'debug=ON  search=' + window.location.search; }

    if (isAutorun()){
      // small delay so layout is ready
      setTimeout(()=>window.runDebugSimulation(), 50);
    }
  });
})();
</script>

</body>
</html>